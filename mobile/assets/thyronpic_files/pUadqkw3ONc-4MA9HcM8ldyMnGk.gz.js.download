var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},__spreadArray,BingAtWork;(function(n){function rt(n,t){var i={},r=n.flights,u;r&&r.length>0&&(i.variants=r.join());for(u in t)i[u]=t[u];return i}function ut(n,t){var i,r;if(t)for(i in t)r=n.indexOf("?")>-1?"&":"?",n+="".concat(r).concat(encodeURIComponent(i),"=").concat(encodeURIComponent(t[i]));return n}function ft(n){var t=7;switch(n){case 500:t=6;break;case 404:t=9;break;case 401:t=4;break;case 504:t=5;break;case 400:t=8}return t}function et(n){for(var r,t,f,u=[],i=1;i<arguments.length;i++)u[i-1]=arguments[i];if(!n)return n;for(r=n,t=0;t<u.length;t++)f=new RegExp("\\{".concat(t,"\\}"),"gm"),r=r.replace(f,arguments[t+1]);return r}function ot(t,i){try{return JSON.parse(t)}catch(r){return null}}function st(n,t,i){var r,u;for(i===void 0&&(i=7),r=n,u=0;r&&u<i;u++){if(r===t)return!0;r=r.parentElement}return!1}function ht(n){n!=null&&n.parentNode!=null&&n.parentNode.removeChild(n)}function c(n,t,i,r,u){r===void 0&&(r=0);n()||(t>1?setTimeout(function(){return c(n,t-1,i,r,u)},i+r):u&&u())}function o(n){if(typeof bfbTel!="undefined"&&bfbTel){n();return}sj_evt.bind("bfbWebTelemetryExists",n,!0,undefined,!0)}function ct(t){if(typeof n.Strings!="undefined"&&n.Strings){t();return}sj_evt.bind("BingAtWork:LocStrings",t,!0,null,!0)}function r(){try{return!!("localStorage"in _w&&_w.localStorage)}catch(n){return!1}}function l(t){var i=a(t);if(i){var u=s(t),r=i.cacheExpiryNum,f=i.cacheValueStr;if(!r||window.isNaN(r)||r<(new Date).getTime())h(u);else try{return JSON.parse(f)}catch(e){h(u)}}return undefined}function a(n){var r=s(n),t=wt(r);if(t){var i=t.split(";",2),u=i[0],f=i[1],e=Number(u);return{cacheValueStr:f,cacheExpiryNum:e}}return undefined}function lt(t,i,u,f,e,o,s){var c,h,v,y;if(o===void 0&&(o=!1),s===void 0&&(s=!1),!r())return i({onSuccess:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];u.onSuccess.apply(u,t);f.onSuccess.apply(f,t)},onError:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];u.onError.apply(u,t);f.onError.apply(f,t)}});if(n._isEventBind||(n._isEventBind=!0,sj_evt.bind("ajax.unload",function(){n._localStorageAutoRefreshHandlersBacklog={};n._localStorageOneOffHandlersBacklog={}},!0,null,!0)),n._localStoragePendingAutoRefreshes=n._localStoragePendingAutoRefreshes||{},n._localStorageAutoRefreshHandlersBacklog=n._localStorageAutoRefreshHandlersBacklog||{},n._localStorageOneOffHandlersBacklog=n._localStorageOneOffHandlersBacklog||{},u){if(n._localStorageAutoRefreshHandlersBacklog[t]&&n._localStorageAutoRefreshHandlersBacklog[t].length>0){n._localStorageAutoRefreshHandlersBacklog[t].push(u);return}n._localStorageAutoRefreshHandlersBacklog[t]=[u]}if(f){if(n._localStorageOneOffHandlersBacklog[t]&&n._localStorageOneOffHandlersBacklog[t].length>0){n._localStorageOneOffHandlersBacklog[t].push(f);return}n._localStorageOneOffHandlersBacklog[t]=[f]}if(c=l(t),c!=null&&!s){h=a(t);v=new Date(h===null||h===void 0?void 0:h.cacheExpiryNum);w(t,c,v,!0,i,e,o,!0);return}s;y=p(t,i,e,o);i(y)}function p(t,r,u,f){var e=s(t);return{onSuccess:function(i){var o=u&&u(i);o&&(w(t,i,o,!1,r,u,f),setTimeout(function(){return k(e,"".concat(o.getTime(),";").concat(JSON.stringify(i)))},0))},onError:function(){for(var u=[],r=0;r<arguments.length;r++)u[r]=arguments[r];i(n._localStorageAutoRefreshHandlersBacklog[t],function(n){n.onError&&n.onError.apply(n,u)});i(n._localStorageOneOffHandlersBacklog[t],function(n){n.onError&&n.onError.apply(n,u)});f||(n._localStorageAutoRefreshHandlersBacklog[t]=[]);n._localStorageOneOffHandlersBacklog[t]=[]}}}function s(t){return"".concat(n.localStorageCacheKeyPrefix).concat(t)}function w(t,r,u,f,e,o,s,h){if(i(n._localStorageAutoRefreshHandlersBacklog[t],function(n){n.onSuccess(r,undefined,h)}),s||(n._localStorageAutoRefreshHandlersBacklog[t]=[]),i(n._localStorageOneOffHandlersBacklog[t],function(n){n.onSuccess(r,undefined,h)}),n._localStorageOneOffHandlersBacklog[t]=[],s&&!n._localStoragePendingAutoRefreshes[t]){var c=Math.max(u.getTime()-(new Date).getTime()+v,f?y:0);n._localStoragePendingAutoRefreshes[t]=!0;setTimeout(function(){var i=p(t,e,o,s);e(i);n._localStoragePendingAutoRefreshes[t]=!1},c)}}function at(t,i,r){var u,f;return(r===void 0&&(r=";"),!((f=(u=n.SessionStorage)===null||u===void 0?void 0:u.isSupported)===null||f===void 0?void 0:f.call(u)))?undefined:vt(n.SessionStorage.getItem(t),i,r)}function vt(n,t,i){if(i===void 0&&(i=";"),!n)return undefined;var u=n.split(i,2),f=u[0],e=u[1],r=Number(f);return!r||window.isNaN(r)||r<=(new Date).getTime()-t?undefined:e}function yt(t,i,r){var u,f;(r===void 0&&(r=";"),(f=(u=n.SessionStorage)===null||u===void 0?void 0:u.isSupported)===null||f===void 0?void 0:f.call(u))&&n.SessionStorage.setItem(t,"".concat((new Date).getTime()).concat(r).concat(i))}function pt(t){try{sessionStorage.removeItem(t)}catch(i){}}function i(n,t){if(n)for(var i=0;i<n.length;i++)t(n[i])}function t(n,t){if(!n)return!1;for(var i=0;i<n.length;i++)if(n[i]===t)return!0;return!1}function b(){var n=function(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)};return n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n()}function k(n,t){if(r())try{localStorage.setItem(n,t)}catch(i){}}function wt(n){if(r())try{var t=localStorage.getItem(n);return t===null?undefined:t}catch(i){}return undefined}function h(t){if(r())try{localStorage.removeItem(t)}catch(i){}}function d(t){var c=t.condition,l=t.maxAttempts,u=t.baseIntervalInMillis,r=t.logName,e=t.callback,f=t.additionalIntervalPerAttemptInMillis,i=t.currentAttempt,s=t.timeOutCallback,h;f=f||0;i=i||0;c()?e!=null&&e():(i++,i<l?(h=__assign(__assign({},t),{baseIntervalInMillis:u+f,currentAttempt:i}),setTimeout(function(){return d(h)},u)):(o(function(){return bfbTel.logDiag("".concat(r,"_TimedOut"))}),s!=null&&s()))}function bt(t,i,r,u,f){for(var s,c,a,y,l=[],h=5;h<arguments.length;h++)l[h-5]=arguments[h];s=new Date;n._throttleRecords||(n._throttleRecords={});c=f.id;c||(c=f.id=b());try{a=JSON.stringify(r)}catch(p){return}var v=f.name||"(anonymous)",o="".concat(v,"_").concat(c,"_").concat(a),e=n._throttleRecords[o];if(e){if(e.totalCalls++,e.clusterCalls++,e.clusterCalls>t)if(y=s.getTime()-e.lastRunTime.getTime(),y>=i)e.clusterCalls=1,e.clusters++;else return e.throttledCalls++,e.lastThrottledCallStack=g("Call throttled"),u(),undefined}else n._throttleRecords[o]={totalCalls:1,clusterCalls:1,allowedCalls:0,throttledCalls:0,firstRunTime:s,lastRunTime:s,clusters:1,name:v};return n._throttleRecords[o].allowedCalls++,n._throttleRecords[o].lastRunTime=s,f.apply(void 0,l)}function g(n){return nt(new Error(n).stack)}function nt(n){return n&&n.replace(/\?.*/gi,"?<query string redacted>")}function kt(t){if(t===void 0&&(t=!0),!n._throttleRecords)return undefined;var r=[],u=Object.keys(n._throttleRecords);return i(u,function(i){var u=n._throttleRecords[i];(!t||u.throttledCalls>0)&&r.push(u)}),r}function dt(){n._throttleRecords={}}function gt(n,t){if(!n)return undefined;for(var i=0;i<n.length;i++)if(t(n[i]))return n[i];return undefined}function ni(n){return n&&n.length==0}function ti(t){try{return atob(t)}catch(i){}}function ii(t,i){typeof n.Localhost!="undefined"&&typeof n.Localhost.augmentMsbMtAjax=="function"&&n.Localhost.augmentMsbMtAjax(t,i)}function ri(n){if(!n.isOnWorkVertical)return undefined;var t=(window.location.hash||"").replace("#",""),i=t.indexOf("-");return t.substring(0,i>-1?i:t.length).toLocaleLowerCase()||"all"}function ei(t,i,r){var h=n.context.isErrBAbsorbEnabled,f,s;try{return i()}catch(e){if(f=e.name||e,s="Exception '".concat(f,"' caught at '").concat(t,"'")+(r?", called by '".concat(r,"'"):""),(_G.TEST_HOOKS_ENABLED||_G.TestEnv)&&alert(s),f&&(tt<fi&&(typeof u[f]=="undefined"||u[f]<ui)&&(o(function(){return bfbTel.logErr(n.EventScope.BingAtWork,s,e.message,"UncaughtError",e.stack)}),u[f]=typeof u[f]=="undefined"?1:u[f]+1,tt++),!h))throw e;}}function oi(t){if(!t)return{token:undefined,error:"Empty token string"};try{var i=t.split(".")[1],r=i.replace(/-/g,"+").replace(/_/g,"/"),u=decodeURIComponent(atob(r).split("").map(function(n){return"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)}).join(""));return{token:JSON.parse(u)}}catch(f){return{token:undefined,error:"Failed to parse token"}}}function si(){return/MSIE|Trident/.test(e())}function e(){return window.navigator.userAgent}function hi(){if(!window.performance)return!1;var n=window.performance.getEntriesByType("navigation");return n.length>0&&n[0].type==="back_forward"||window.performance.navigation.type===window.performance.navigation.TYPE_BACK_FORWARD}function ci(n){var t=function(){sb_st(n,100);sj_evt.unbind("aad:signedin",t)};sj_evt.bind("aad:signedin",t,!0,undefined,!0)}function it(){var n=e();return t(n,"OPR/")||t(n,"Opera")?"Opera":t(n,"PhantomJS")?"PhantomJS":t(n,"Edg")?"Edge":t(n,"Electron")?"Electron":t(n,"Chrome")?"Chrome":t(n,"Trident")?"MSIE":t(n,"Firefox")?"Firefox":t(n,"Safari")?"Safari":t(n,"SkypeShell")?"SkypeShell":"Unknown"}function li(){var r,n=e(),t=it(),i;return t==="MSIE"?r=ai(n):t==="Edge"?(i=f(n,t),r=i==="Unknown"?f(n,"Edg"):i):t==="Opera"?(i=f(n,t),r=i==="Unknown"?f(n,"OPR"):i):r=f(n,t),r}function ai(n){var i=n.match(new RegExp("MSIE ([\\d,.]+)")),t;return i?i[1]:(t=n.match(new RegExp("rv:([\\d,.]+)")),t?t[1]:"Unknown")}function f(n,t){t==="Safari"&&(t="Version");var i=n.match(new RegExp(t+"/([\\d,.]+)"));return i?i[1]:"Unknown"}var v,y;n.bawSourceName="BingAtWork";n.msPerDay=864e5;n.getRequestMetadata=rt;n.mergeArgsIntoUrl=ut;n.getError=ft;n.strFormat=et;n.tryParseJson=ot;n.hasAncestorElement=st;n.removeElement=ht;n.retryPoll=c;n.whenWebTelemetryExists=o;n.whenLocStringsAvailable=ct;n.isLocalStorageSupported=r;n.getCacheValueIfValid=l;n.localStorageCacheKeyPrefix="MSBLS_";v=18e4;y=3e4;n.withLocalStorageCache=lt;n.getSessionStorage=at;n.writeSessionStorage=yt;n.removeSessionStorageItem=pt;n.forEach=i;n.includes=t;n.generateGuid=b;n.setItemForLocalStorage=k;n.removeItem=h;n.poll=d;n.throttle=bt;n.getSanitizedCallStack=g;n.redactQueryStrings=nt;n.getThrottleRecords=kt;n.resetThrottleRecords=dt;n.find=gt;n.isEmpty=ni;n.decodeBase64=ti;n.augmentMsbMtAjax=ii;n.getStartedEventDetails=function(){return{startTime:new Date,startTimeStartDuration:performance.now()}};n.getSucceededEventDetails=function(n,t,i){return{endTime:new Date,endTimeStartDuration:performance.now(),response:n,headers:t,status:200,isFromCache:i}};n.getFailedEventDetails=function(n,t){return{endTime:new Date,endTimeStartDuration:performance.now(),error:n,status:t}};n.getLoweredWorkSerpVerticalDomain=ri;var u={},tt=0,ui=5,fi=30;n.withErrorBoundary=ei;n.parseJwt=oi;n.isHostIE=si;n.getUserAgent=e;n.isBackForwardNavigation=hi;n.bindForAad=ci;n.getBrowserName=it;n.getBrowserVersion=li})(BingAtWork||(BingAtWork={}));__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},function(n){function i(n,t){if(t===void 0&&(t=0),n==null)throw new Error("arg ".concat(t," is null"));return n}function c(t,i){try{var r=t();return typeof r=="undefined"||r===null?i:r}catch(u){return i}}function t(n){var t=new RegExp("^\\s*$");return n==null||t.test(n)}function l(n,t){var r=i(n).toLowerCase(),u=i(t,1).toLowerCase();return r.indexOf(u)>=0}function a(t,i){var f,r;return t==null?null:i?(r=u(t.ScopeAnalysis),{UserInfo:t.UserInfo,Items:r!=null&&r.QasIndexItems!=null&&r.QasIndexItems.length>0?JSON.parse(r.QasIndexItems[0].Metadata):null}):(f=n.getCommandItemGroups(t),f!=null?f[0]:null)}function u(n){return n==null||n.length===0?null:n[0]}function v(n,t){return{onSuccess:n,onError:t.onError}}function y(n){return n.length>1?n[1]:null}function p(n){var t=new Date;return t.setTime(t.getTime()+n*6e4),t}function f(i){if(i=e(i),t(i))return"";var r=n.getParameterByName("ue",i),u=t(r)?n.getParameterByName("q",i):r;return t(u)?"":u.trim()}function w(n){var i=f(n),u;return t(i)?"":(u=r(i.replace(/[<>\(\)\'\"]+/gi,"")),t(u))?"":r(i)}function b(i){if(i=e(i),t(i))return"";var r=n.getParameterByName("form",i);return r==null?null:r.trim()}function r(n){return n.replace(/^[\`\!\@\#\$\%\^\&\*\)\_\+\=\-\,\.\/\;\:\[\]\\\{\}\|\~\?\¿]+/gi,"").replace(/[\`\!\@\#\$\%\^\&\*\(\_\+\=\-\,\.\/\;\:\[\]\\\{\}\|\~\?\¿]+$/gi,"").replace(/('s )/gi," ").replace(/[ ]+/gi," ").toLowerCase()}function e(n){return t(n)?_w.location.href:n}function k(n){return n==null?"":_G!=null&&_G.Mkt!=null?n.toLocaleString(_G.Mkt).replace(/\.00$/,""):n.toString()}function d(n,t){return n==null||n.ScopeAnalysis==null||n.ScopeAnalysis.length<1?!1:t==null||t.length<1?!1:n.ScopeAnalysis.some(function(n){return t.indexOf(n.Domain)>-1})}function g(t,i){var r=n.isLocalStorageSupported()?localStorage.getItem(n.LocalStorageEnums.pinned.key):null,u=r==null?i:r===n.LocalStorageEnums.pinned["true"];return(t&&u)===!0}function nt(n,t,i){t===void 0&&(t="jpeg");i===void 0&&(i=!0);var r="data:image/".concat(t,";base64,").concat(n);return i&&r?"url(".concat(r,")"):r}function tt(n,t){var i=t[n];return i==null?undefined:t[i]}function it(t){var i=n.getMFASignInUrl(t);i!=null&&window.location.replace(i)}function rt(t){var i,r,u;return(t=(r=(i=t===null||t===void 0?void 0:t.replace(/\([\s\S]*?\)/g,""))===null||i===void 0?void 0:i.replace(/\[[\s\S]*?\]/g,""))===null||r===void 0?void 0:r.replace(/\{[\s\S]*?\}/g,""),n.includes(t,","))?((u=t===null||t===void 0?void 0:t.split(",")[1])===null||u===void 0?void 0:u.trim())||"":(t===null||t===void 0?void 0:t.split(" ")[0])||""}function ut(t){var e,o,s,l=n.context.isWebGroupAnswerDisabledClientSide,u,i,r,f,h,c;return l?(u=[],i=[],(e=t.AnswerEntitySets)===null||e===void 0?void 0:e.forEach(function(n){var r=n.EntityType==="Group",t;r?n.ResultSets.forEach(function(n){n.Results.forEach(function(n){u.push(n.Id)})}):n.EntityType==="People"?(t=[],n.ResultSets.forEach(function(n){var i=[];n.Results.forEach(function(n){n.Source.PeopleType==="Group"?u.push(n.Id):i.push(n)});i.length&&t.push(__assign(__assign({},n),{Results:i}))}),t.length&&i.push(__assign(__assign({},n),{ResultSets:t}))):i.push(n)}),r=[],(o=t.WholePageRankings)===null||o===void 0?void 0:o.forEach(function(n){var t=[];n.EntityCards.forEach(function(n){var i,r=(i=n.EntityIds)===null||i===void 0?void 0:i.filter(function(n){return u.indexOf(n)===-1});(r===null||r===void 0?void 0:r.length)&&t.push(n)});t.length&&r.push(n)}),f=[],(s=t.Ranking)===null||s===void 0?void 0:s.EntityCards.forEach(function(n){var t,i=(t=n.EntityIds)===null||t===void 0?void 0:t.filter(function(n){return u.indexOf(n)===-1});(i===null||i===void 0?void 0:i.length)&&f.push(n)}),h=f.length?__assign(__assign({},t.Ranking),{EntityCards:f}):undefined,c=__assign(__assign({},t),{AnswerEntitySets:(i===null||i===void 0?void 0:i.length)?i:undefined,Ranking:h,WholePageRankings:(r===null||r===void 0?void 0:r.length)?r:undefined}),c):t}function o(){var t=n.context,i=t.wsb,r=t.isOnWorkVertical,u=t.isSharedSerpWorkBundlesEnabled;return!!(!i&&r&&u)}function h(){s=!0;sj_evt.unbind("bfbRouterInitializedEvent",h)}function ft(){sj_evt.bind("bfbRouterInitializedEvent",h,!0)}function et(){return s&&o()}function ot(n){sj_evt.fire("bfbUrlChangeRequeryEvent",n)}n.chk=i;n.safeGet=c;n.nullOrWs=t;n.containIgnoreCase=l;n.getResp=a;n.getFirstScopeAnalysis=u;n.cpyErr=v;n.secondOrNull=y;n.getDateAddMinutes=p;n.getRawQuery=f;n.getNormalizedQuery=w;n.getFormCodeFromUrl=b;n.normalizeQuery=r;n.localizeNumber=k;n.hasDomain=d;n.isPinned=g;n.imgSrc=nt;n.enumPropertyToValue=tt;n.redirectToMFASignIn=it;n.getFirstNameOrFullName=rt;n.removeDisabledAnswersFrom3sResponse=ut;n.isSharedSerpOnlyBundle=o;var s=!1;n.initAutoSuggest=ft;n.isMsbHandlingAutoSuggestRequery=et;n.handleAutoSuggestRequery=ot}(BingAtWork||(BingAtWork={})),function(n){function e(){return"/orgid/simplesignout"}function o(n,t,i,r){var u="/work/search?q=".concat(encodeURIComponent(n),"&ue=").concat(encodeURIComponent(t));return r!=null&&(u+="&bfbqi=".concat(r)),i!=null&&(u+="&FORM=".concat(encodeURIComponent(i))),u}function s(t,i,r){return"/work/search?q=".concat(encodeURIComponent(t),"&bfbqi=").concat(n.QueryIntent.Group,"&bfbgid=").concat(encodeURIComponent(i),"&FORM=").concat(encodeURIComponent(r))}function h(t){return"/work/search?q=building%20".concat(encodeURIComponent(t),"&ue=&bfbqi=").concat(n.QueryIntent.Building,"&FORM=BAWBMD")}function c(t,i,r){return n.strFormat(t,encodeURIComponent(i),encodeURIComponent(r||""))}function l(t,i,r,u){return n.strFormat(t,encodeURIComponent(i),encodeURIComponent(r),encodeURIComponent(u||""))}function a(n,t){var i="/work/search?q=".concat(encodeURIComponent(n));return t!=null&&(i+="&FORM=".concat(encodeURIComponent(t))),i}function v(n,t){return"/business/mtr/iras?e=".concat(n,"&c=").concat(t)}function y(i){var u=window.location.href,h=t("login_hint",u)||"",c=t("domain_hint",u)||"",l=t("redir",u),e=(Number(l)||1)+1,a=t("mfaredir",u),o=(Number(a)||1)+1,s;if(!(e>6)&&!(o>2))return u=f("itrid",u),u=r("redir","".concat(e),u),u=r("mfaredir","".concat(o),u),s=encodeURIComponent(u),n.strFormat(i,s,h,c,!0)}function u(n){var t=n.replace(/\+/g," ");return decodeURIComponent(t)}function t(n,t){var r=n.toLowerCase(),u=i(t);return u[r]}function r(t,r,u){var e=t.toLowerCase(),o=u.substring(0,u.indexOf("?")),f=i(u);return f[e]=r,n.mergeArgsIntoUrl(o,f)}function f(t,r){var f=t.toLowerCase(),e=r.substring(0,r.indexOf("?")),u=i(r);return delete u[f],n.mergeArgsIntoUrl(e,u)}function p(t){if(n.nullOrWs(t))return"";var i=new RegExp(/(\D*x).*$/ig),r=new RegExp(/\D/g);return"tel:+"+t.replace(i,"").replace(r,"")}function w(n){return"mailto:".concat(n)}function b(n,t,i,r){return t&&!r?i?"ms-sfb://start":"ms-sfb://chat?id=".concat(n):"sip:".concat(n)}function k(){return"/business/uid"}function i(n){var i=n.substring(n.indexOf("?")+1),t={};return i.split("&").forEach(function(n){var i=n.split("=");i!=null&&i[0]!=null&&i[1]!=null&&(t[i[0].toLowerCase()]=u(i[1]))}),t}n.getSignOutUrl=e;n.getUserUrl=o;n.getGroupUrl=s;n.getBuildingMapUrl=h;n.getRoomInfoUrl=c;n.getFloorPlanUrl=l;n.getWorkSearchUrl=a;n.getMtrUrl=v;n.getMFASignInUrl=y;n.decodeQuery=u;n.getParameterByName=t;n.updateParameterByName=r;n.deleteParameterByName=f;n.getPhoneNumberUrl=p;n.getEmailUrl=w;n.getMessengerUrl=b;n.getFetchUidUrl=k;n.buildQueryParameters=i}(BingAtWork||(BingAtWork={}));__spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},function(n){function u(t){n.writeSessionStorage("BingAtWorkConversationId",t)}var i=[],r,t;n.isWindow=function(){return typeof window!="undefined"&&!!window};r=function(){function r(){this.signoutEvtHandlerAdded=!1;this.signoutRetentionNotification="SignoutRetention";this.dwell={};this.queryRegex=new RegExp(/[^/](query|((\?|&)(q|pq)))(?:\"?)(?: ?)([:=])/i);this.nameRegex=new RegExp(/name(?:\"?)(?: ?)([:=])/i);this.userRegex=new RegExp(/user(?:\"?)(?: ?)([:=])/i);this.UPNRegex=new RegExp(/((userprincipalname)|(upn))(?:\"?)(?: ?)([:=])/i);this.emailRegex=new RegExp(/(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))/);this.QueryRule={key:"Query",regex:this.queryRegex};this.NameRule={key:"Name",regex:this.nameRegex};this.UserRule={key:"User",regex:this.userRegex};this.UPNRule={key:"UPN",regex:this.UPNRegex};this.EmailRule={key:"Email",regex:this.emailRegex};this.RuleSet=[this.EmailRule,this.QueryRule,this.NameRule,this.UserRule,this.UPNRule,];this.checkRules=function(n){var t=!0;return this.RuleSet.forEach(function(i){i.regex.test(n)&&(t=!1)}),t};this.dwellOnUnload=this.dwellOnUnload.bind(this)}return r.init=function(n){typeof bfbTel!="undefined"&&bfbTel.initialized||n!=null&&!n.isMtr&&n.cfg!=null&&n.cfg.e&&n.cfg.env!=="TEST"&&(bfbTel.setContext(n),bfbTel.regLogPagePerf(),bfbTel.regTenantSettingsUpdate(),sj_evt.fire("bfbWebTelemetryInitReady"))},r.prototype.setContext=function(r){var u=this,s,e,f,a,h;for(this.ctx=r,this.initialized||(this.initialized=!0,this.ariaLogger=AriaTelemetry.getLogger(r.cfg.t),sj_evt.bind("beforeunload",function(){var t=n.context;(t.wsb||n.isWindow()&&!window.MSLog)&&u.ariaLogger.flushAndTeardown()}),e=(s=n.context===null||n.context===void 0?void 0:n.context.mtCfg)===null||s===void 0?void 0:s.flights,e&&(e.indexOf("bfblqost")>-1&&this.logDiag("immediate trigger",{eventId:"qosTest"}),e.indexOf("bfblqost2s")>-1&&setTimeout(function(){return u.logDiag("2 second delay trigger",{eventId:"qosTest"})},2e3)));i.length>0;){var o=i.shift()||{},c=o.s,l=o.n,v=o.kv,y=o.noContextualKV;c&&l&&this.log(c,l,v,y)}f=this.ctx.isHomepage;sj_evt.bind("bfbWebTelemetryInitReady",function(){var i={};i.alreadySignedIn=n.context&&!!n.context.isAadAuthenticatedAtServer;i.ssoSignedIn=n.context&&!!n.context.isAadAuthenticatedBySSO;u.log(f?t.BingAtWorkHomepage:t.BingAtWork,"SignedIn_Events",i)},!0,undefined,!0);sj_evt.bind("aad:signedin",function(i){var e,r={},o=(e=i[1])===null||e===void 0?void 0:e.userObjectId;n.context&&(r.alreadySignedIn=!!n.context.isAadAuthenticatedAtServer,n.context.isAadAuthenticatedBySSO=u.lastSSOAttempt!==null,r.ssoSignedIn=n.context.isAadAuthenticatedBySSO);o&&(u.ctx.uid=o,n.context&&(n.context.aadUserId=o));r.latency=u.lastSSOAttempt!==undefined?(performance.now()-u.lastSSOAttempt).toFixed(2):"-1";u.lastSSOAttempt=undefined;u.log(f?t.BingAtWorkHomepage:t.BingAtWork,"SignedIn_Events",r)},!0,undefined,!0);sj_evt.bind("aad:signedout",function(){var i={};n.context&&(n.context.isAadAuthenticatedBySSO=!1);i.latency=u.lastSSOAttempt!==undefined?(performance.now()-u.lastSSOAttempt).toFixed(2):"-1";u.lastSSOAttempt=undefined;u.log(f?t.BingAtWorkHomepage:t.BingAtWork,"SsoError_Events",i)},!0,undefined,!0);sj_evt.bind("aad:ssoattempt",function(){u.lastSSOAttempt=performance.now()},!0,undefined,!0);sj_evt.bind("ajax.unload",function(){u.dwellOnUnload("A")});_w.addEventListener("beforeunload",function(){u.dwellOnUnload("W")});a=function(){u.logSignout(f?t.BingAtWorkHomepage:t.BingAtWork)};h=function(){n.poll({condition:function(){var t=_ge("postLink");return!u.signoutEvtHandlerAdded&&t&&(sj_be(t,"click",a),u.signoutEvtHandlerAdded=!0),u.signoutEvtHandlerAdded},maxAttempts:50,baseIntervalInMillis:100,logName:"SignoutButton:polling"})};sj_be(_ge("id_n"),"click",h);sj_be(_ge("id_p"),"click",h);sj_evt.bind("Identity.SignoutNotifShown",function(){u.logShown(n.EventScope.UserNotification,0,undefined,{eventId:"Notification_Impression",notificationKind:u.signoutRetentionNotification})});sj_evt.bind("Identity.SignoutNotifSignoutClick",function(){u.logClicked(n.EventScope.UserNotification,!1,undefined,undefined,{eventId:"Notification_Dismiss_Click",notificationKind:u.signoutRetentionNotification})});sj_evt.bind("Identity.SignoutNotifBackgroundClick",function(){u.logClicked(n.EventScope.UserNotification,!1,undefined,undefined,{eventId:"Notification_Hide_BackgroundClick",notificationKind:u.signoutRetentionNotification})});sj_evt.bind("Identity.SignoutNotifCancelClick",function(){u.logClicked(n.EventScope.UserNotification,!1,undefined,undefined,{eventId:"Notification_Engagement_Click",notificationKind:u.signoutRetentionNotification})})},r.prototype.logShown=function(n,t,i,r){t!=null&&(r=r||{},r.T=String(t));i!=null&&(r=r||{},r.S=i);this.log(n,"Shown_Events",r);this.fireImpressionForMipnTelemetry(n,r)},r.prototype.fireImpressionForMipnTelemetry=function(n,i){if(n===t.UserNotification&&i&&i.notificationKind&&sj_evt.fire("MIPN.Telemetry.".concat(i.notificationKind,"Notification.Impression")),i&&i.eventId&&typeof i.eventId=="string"){var f=i.eventId,u=r.conversionLinkImpressionEventMap[f];u&&sj_evt.fire("MIPN.Telemetry.".concat(u,"ConversionLink.Impression"))}},r.prototype.logRanking=function(n,i,r,u){var f=n||{placement:null,treatment:null,rankingRuleId:null,legend:null},e=f.placement,o=f.treatment,s=f.rankingRuleId,h=f.legend,c={P:e,T:o,R:s,L:h,MTHD:i,AUD:r==null?null:r?1:0,ERR:u?"UNEXPCTRL":null};this.log(t.BingAtWork,"Ranking_Events",c)},r.prototype.logQuery=function(n,i){var r;if(n){var u=n.encryptedQuery,f=n.queryCount,e=n.queryFrequency,o=n.bhvr,s=n.webIntentConf,h=n.ssp,c=n.intent,l=n.groupId;r={QRY:u,CNT:f,FRQ:e,BHVR:o,CONF:s,SSP:h,INT:c,GID:l}}else r={NWK:1,QID:i};console.log("*** TEST");this.log(t.BingAtWork,"Query_Events",r)},r.prototype.logClicked=function(n,i,u,f,e){u!=null&&(e=e||{},e.T=u);f!=null&&(e=e||{},e.S=f);this.log(n,"Clicked_Events",e);this.fireClickForMipnTelemetry(n,e);this.ctx&&this.ctx.sci&&(i?this.sendExternalClickRateInst():this.inst(r.instClickEventType,"BfbClick",{BFB_EXT:i?"1":"0",BFB_T:u,BFB_S:f,BFB_SC:t[n]}));var o={scope:n,target:u,source:f,properties:e};sj_evt.fire("BingAtWork:Click",o)},r.prototype.fireClickForMipnTelemetry=function(n,i){var u,f,e;i&&i.eventId&&typeof i.eventId=="string"&&(u=i.eventId,n===t.UserNotification&&i&&i.notificationKind&&(f=r.notificationClickToTelemetryEventMap[u],f&&sj_evt.fire("MIPN.Telemetry.".concat(i.notificationKind,"Notification.").concat(f))),e=r.conversionLinkClickEventMap[u],e&&sj_evt.fire("MIPN.Telemetry.".concat(e,"ConversionLink.EngagementClick")))},r.prototype.logValue=function(n,t,i,r){r=r||{};r.N=t;r.V=i;this.log(n,"Value_Events",r)},r.prototype.logSignout=function(n,t,i,r){this.logClicked(n,!1,t,i,r);this.log(n,"SignedOut_Events",r)},r.prototype.logRtt=function(n,t,i,r){var u=this.getRequestRtt(i,r);if(u&&!(u.getCall<0)&&!(u.startCall<0)){var f=u==null?"NOPERF":u.getCall.toFixed(2),e=u==null?"NOPERF":u.startCall.toFixed(2),o={N:t,V:f,ST:e};this.log(n,"Rtt_Events",o)}},r.prototype.logSerpLinkClick=function(n,i){var r={T:"SERP",DOM:n,SERPID:i};this.log(t.Serp,"Clicked_Events",r)},r.prototype.logDiag=function(n,i){i=i||{};i.MSG=n;this.log(t.Diag,"Diag_Events",i)},r.prototype.logErr=function(n,t,i,r,u,f,e){if(f=f||{},f.eventId=r==="UncaughtError"?r:t,f.message=t,this.checkIfPIIClean(i)&&(f.fullMsg=i),u){var o=this.sanitizeUrls(u);this.checkIfPIIClean(o)&&(f.stackTrace2=o)}this.log(n,"Errors",f,e)},r.prototype.regLogPagePerf=function(){var i=this,t;performance!=null&&performance.getEntries!=null&&(t=function(){i.logPagePerf();sj_evt.unbind("onP1",t)},sj_evt.bind("onP1",t,!0,0,!1))},r.prototype.logPagePerf=function(){for(var n,f,e,i=0,u=performance.getEntries();i<u.length;i++){n=u[i];for(f in r.pagePerfMatchConfig)r.pagePerfMatchConfig[f](n)&&(e={N:f,P:n.name,ET:n.entryType,IT:n.initiatorType,FETCH_S:n.fetchStart,REQ_S:n.requestStart,RES_S:n.responseStart,RES_E:n.responseEnd,D:n.duration,TSZ:n.transferSize},this.log(t.BingAtWork,"Perf_Events",e))}},r.prototype.log=function(n,t,r,u){r===void 0&&(r={});this.ariaLogger!=null?this.logInternal(n,t,r,u):i.push({s:n,n:t,kv:r,noContextualKV:u})},r.prototype.logInternal=function(i,r,u,f){var e,o,s,h,c;if(u===void 0&&(u={}),e={eventType:"Client_Events",name:r||"",properties:{}},f||this.fillContextualKV(i,u),u!=null)for(o=0,s=Object.getOwnPropertyNames(u);o<s.length;o++)h=s[o],c=u[h],e.properties[h]={value:c!=null?c:""};this.ariaLogger.logEvent(e)},r.prototype.fillContextualKV=function(t,i){var r=this.ctx,e=r.cfg,o=r.uid,s=r.ig,h=r.tid,c=r.sid,l=r.muid,a=r.tn,v=r.tnid,y=r.msa,p=r.mkt,w=r.b,b=r.dev,k=r.os,d=r.osver,g=r.dc,nt=r.snrVersion,tt=r.canvas,f=typeof _G=="undefined"?{IG:s,EventID:h}:_G,u=n.context,it=u&&u.isEudbEnforced,rt=u&&u.formCode||"";i.ENV=e.env;i.environment=e.env;i.SC=t;i.IG=f.IG;i.impressionGuid=f.IG;i.SID=c;i.TID=f.EventID;it||(i.UID=o);i.MUID=l;i.F=rt;i.TN=a;i.TNID=v;i.MSA=y;i.MKT=p;i.B=w;i.deviceType=b;i["DeviceInfo.OsName"]=k;i["DeviceInfo.OsVersion"]=d;i.dataCenter=g;i.clientType=this.getClientType(u);i.snrVersion=nt;i.logicalSearchId=u&&u.logicalId;i.conversationId=u&&u.conversationId;i.canvas=tt;i.isSnr=!0},r.prototype.getClientType=function(n){return(n===null||n===void 0?void 0:n.isOnWorkVertical)&&(n===null||n===void 0?void 0:n.wsb)?"WsbBingVertical":(n===null||n===void 0?void 0:n.isOnWorkVertical)?"BingVertical":(n===null||n===void 0?void 0:n.wsb)?"Wsb":"Bing"},r.prototype.getRequestRtt=function(t,i){var e=this,f,u,r;return performance==null||performance.getEntries==null?null:(f=performance.getEntries(),u=f.filter(function(r){if(r.name==null)return!1;var u=function(t){var i=r.name.toLowerCase(),u=e.getPathName(i)==="/search";return!u&&n.hasSub(i,t)};return t.every(u)&&(i==null||!i.some(u))}),u.length<1)?{getCall:-1,startCall:-1}:(r=u[0],{getCall:r.duration,startCall:r.fetchStart||r.startTime})},r.prototype.getPathName=function(n){var t=document.createElement("a");return t.href=n,t.pathname},r.prototype.sendExternalClickRateInst=function(){if(typeof _w.si_ct=="function"){var n=_ge("bfb_ExternalLink")||_ge("bfb_InstrumentationLink");n&&_w.si_ct(n)}},r.prototype.instCommand=function(n){this.inst(r.instEventType,"BfbCommand",n)},r.prototype.instAnswerExpansion=function(n){this.inst(r.instEventType,"BfbAnswerExpanded",{V:"1",P:n})},r.prototype.instGleam=function(n){this.inst(r.instEventType,"BfbGleam",{N:n})},r.prototype.instPLT=function(n){this.inst(r.instEventType,"BawPLT",{V:n})},r.prototype.instUserStatus=function(t){var i={};(t===null||t===void 0?void 0:t.ageInDays)&&(i.AgeInDays=t.ageInDays.toString());n.context.isContributedToBingEnabled&&typeof(t===null||t===void 0?void 0:t.isContributedToBingByMsb)=="boolean"&&(i.IsContributedToBingByMsb=t.isContributedToBingByMsb.toString());i&&this.inst(r.instEventType,"UserStatus",i)},r.prototype.instSubsequentLogicalId=function(n){this.inst(r.instEventType,"SubsequentLogicalId",{logicalId:n})},r.prototype.inst=function(t,i,u){for(var o,f=[],e=0,s=Object.getOwnPropertyNames(u);e<s.length;e++)o=s[e],f.push(o),f.push(u[o]||"");Log.Log.apply(Log,__spreadArray([t,i,r.instEventName,!1],f,!1))},r.prototype.dwellStart=function(i,r){var u=this,f;f={DW_S:Date.now(),S:r};n.poll({condition:function(){return u.ctx!=null},maxAttempts:50,baseIntervalInMillis:50,logName:"WebTelemetry.dwellStart:polling",callback:function(){u.fillContextualKV(i,f);u.dwell[i]=f}})},r.prototype.dwellEnd=function(i){this.logDwell(i);try{delete this.dwell[i]}catch(r){this.dwell[i]=null}},r.prototype.logDwell=function(n,t){var i=this.dwell[n];if(i&&i.DW_S){var u=i.DW_S,r=Date.now(),f=r-u;i.N="DWELL";i.V=f;i.DW_E=r;i.DW_UL=t;this.log(n,"Value_Events",i,!0)}},r.prototype.dwellOnUnload=function(n){for(var i,t=0,r=Object.getOwnPropertyNames(this.dwell);t<r.length;t++)i=r[t],this.dwell.hasOwnProperty(i)&&this.dwell[i]&&this.logDwell(i,n);this.ariaLogger.flush()},r.prototype.regTenantSettingsUpdate=function(){var t=this;sj_evt.bind("bfbTenantSettings",function(i){var r=i[1];t.ctx.tn=r.tenantDisplayName;t.ctx.tnid=t.ctx.tnid||r.tenantObjectId;n.context&&!n.context.tenantId&&(n.context.tenantId=r.tenantObjectId)},!0,undefined,!0)},r.prototype.sanitizeUrls=function(n){var r=new RegExp(/(?:https?|ftp):\/\/[^ ()]+/g),u=new RegExp(/\/[A-Za-z0-9\_]+.js:[0-9]+:[0-9]+/g),t=n===null||n===void 0?void 0:n.match(r),i=n;return t===null||t===void 0?void 0:t.forEach(function(n){var t,r=(t=n===null||n===void 0?void 0:n.match(u))===null||t===void 0?void 0:t.shift(),f="[URL Removed]".concat(r||"");i=i.replace(n,f)}),i},r.prototype.checkIfPIIClean=function(n){var t=!1;try{t=this.checkRules(n)}catch(i){}return t},r.instEventType="ClientInst",r.instClickEventType="DHTMLClick",r.instEventName="BAW",r.conversionLinkImpressionEventMap={Mainline_SNR_Low_Confidence_See_Results_Impression:"MainlineSNRLowConfidenceSeeResults",Tenant_To_Homepage_Impression:"TenantToHomepage",Tenant_To_ZQ_Impression:"TenantToZQ",Tenant_To_BackArrow_Impression:"TenantToBackArrow",Tenant_To_Chat_Impression:"TenantToChat",Header_To_ZQ_Impression:"HeaderToZQ"},r.conversionLinkClickEventMap={Mainline_SNR_Low_Confidence_See_Results_Click:"MainlineSNRLowConfidenceSeeResults",Tenant_To_Homepage_Click:"TenantToHomepage",Tenant_To_ZQ_Click:"TenantToZQ",Tenant_To_BackArrow_Click:"TenantToBackArrow",Tenant_To_Chat_Click:"TenantToChat",Header_To_ZQ_Click:"HeaderToZQ"},r.notificationClickToTelemetryEventMap={Notification_Dismiss_Click:"DismissClick",Notification_Engagement_Click:"EngagementClick",Notification_Hide_BackgroundClick:"BackgroundClick"},r.pagePerfMatchConfig={"RMS:BfbCssBundle":function(n){return n.name.match(/\/rms\/BfbCssBundle\//)},"RMS:BfbPreBundle":function(n){return n.name.match(/\/rms\/BfbPreBundle\//)},"RMS:BfbBundle":function(n){return n.name.match(/\/rms\/BfbBundle\//)},"RMS:BfbDependencies":function(n){return n.name.match(/\/rms\/BfbDependencies\//)}},r}();n.WebTelemetry=r,function(n){n[n.Serp=-1]="Serp";n[n.BingAtWork=0]="BingAtWork";n[n.BfbController=1]="BfbController";n[n.Gleam=2]="Gleam";n[n.Upsell=3]="Upsell";n[n.Feedback=4]="Feedback";n[n.Paw=5]="Paw";n[n.SkypeClient=6]="SkypeClient";n[n.Person=7]="Person";n[n.Document=8]="Document";n[n.Bookmark=9]="Bookmark";n[n.Building=10]="Building";n[n.FloorPlan=11]="FloorPlan";n[n.OrgChart=12]="OrgChart";n[n.Group=13]="Group";n[n.RefQna=14]="RefQna";n[n.PowerBi=15]="PowerBi";n[n.BookmarkSuggest=16]="BookmarkSuggest";n[n.ExploreQuery=17]="ExploreQuery";n[n.Carousel=18]="Carousel";n[n.WebResult=19]="WebResult";n[n.PowerApps=20]="PowerApps";n[n.Conversation=21]="Conversation";n[n.EmbeddedController=22]="EmbeddedController";n[n.UserNotification=23]="UserNotification";n[n.SuggestedQueries=24]="SuggestedQueries";n[n.Site=25]="Site";n[n.ExplorePage=26]="ExplorePage";n[n.LandingPage=27]="LandingPage";n[n.Mainline=37]="Mainline";n[n.BingAtWorkHomepage=43]="BingAtWorkHomepage";n[n.BingAtWorkChromeNewTab=44]="BingAtWorkChromeNewTab";n[n.UnconsciousArrivalUpsell=45]="UnconsciousArrivalUpsell";n[n.LowConfidenceGleam=46]="LowConfidenceGleam";n[n.Rewards=47]="Rewards";n[n.RightRail=60]="RightRail";n[n.BingAtWorkNeo=70]="BingAtWorkNeo";n[n.ErrorPage=83]="ErrorPage";n[n.BceAdminControls=90]="BceAdminControls";n[n.Diag=999]="Diag"}(t=n.EventScope||(n.EventScope={}));n.writeConversationId=u;typeof bfbTel=="undefined"&&(bfbTel=new r,sj_evt.fire("bfbWebTelemetryExists"))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){function i(t,i,r,u){return{onSuccess:function(i,f,e){if(i&&(sj_evt.fire(t,i,r,f,e,n.getSucceededEventDetails(i,f,e)),u&&u.onSuccess))u.onSuccess(i)},onError:function(r,f,e){if(sj_evt.fire(i,r,f,e,n.getFailedEventDetails(r,f)),u&&u.onError)u.onError(r,f,e)}}}t.getResponseHandlers=i})(t=n.WebTelemetry||(n.WebTelemetry={}))}(BingAtWork||(BingAtWork={})),function(n){function o(t,i,f){var e=function(){if(u){var i=[t.url,t.requestType],e=function(){t.onError&&t.onError(7,0,"throttled")};n.throttle(10,1e4,i,e,r,t,f)}else r(t,f)};(n.context===null||n.context===void 0?void 0:n.context.isErrorBoundaryEnabled)&&n.withErrorBoundary?n.withErrorBoundary("sendAjax",e,i):e()}function r(t,r){var y,a,d,g,h,nt;if(t!=null){var tt=t.timeout,p=t.onSuccess,c=t.onError,l=t.url,w=t.body,it=t.tries,ft=t.requestType,b=t.headers,et=t.convertPropertiesToPascalCase,k=t.accessToken,o=window===null||window===void 0?void 0:window.parent;f&&(a=(y=o===null||o===void 0?void 0:o.BingAtWork)===null||y===void 0?void 0:y.wsb,k=t.accessToken||(a===null||a===void 0?void 0:a.wsbAccessToken));var u=e?typeof(o===null||o===void 0?void 0:o.sj_gx)=="function"?o===null||o===void 0?void 0:o.sj_gx():new XMLHttpRequest:sj_gx(),rt=ft||"GET",ut=function(){return u.open(rt,l,!0)},v=n.redactQueryStrings(l);if(ut(),u.withCredentials=!t.disableWithCredentials,d=function(){return c&&c(5,504,null)},u.ontimeout=(n.context===null||n.context===void 0?void 0:n.context.isErrorBoundaryEnabled)&&n.withErrorBoundary?function(){return n.withErrorBoundary("Ajax.ontimeout",d,"Ajax ".concat(v))}:d,u.timeout=tt==null?0:tt,g=it||1,h=function(t,i,r,u){n.whenWebTelemetryExists(function(){return bfbTel.logDiag(u,{url:l,reason:i})});c!=null&&c(i,t,r)},k!=null&&u.setRequestHeader("Authorization","Bearer ".concat(k)),s()&&rt==="POST"&&u.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),b)for(nt in b)u.setRequestHeader(nt,b[nt]);u.onreadystatechange=function(){var t,f,s,c,e,o;if(u.readyState===4)if(u.status===200){if(p!=null){if(t=null,f={},u.responseText!=null&&u.responseText!=="")try{t=r?u.responseText:JSON.parse(u.responseText)}catch(l){(n.context===null||n.context===void 0?void 0:n.context.isErrorBoundaryEnabled)&&n.withErrorBoundary?n.withErrorBoundary("Ajax.onAjaxError",function(){return h(-1,10,u.responseText,"Bad data")},"Ajax ".concat(v)):h(-1,10,u.responseText,"Bad data");return}if(u.HEADERS_RECEIVED)try{s=u.getAllResponseHeaders();c=s.trim().split(/[\r\n]+/);c.forEach(function(n){var t=n.split(": "),i=t.shift(),r=t.join(": ");f[i]=r})}catch(a){}t=et?i(t):t;(n.context===null||n.context===void 0?void 0:n.context.isErrorBoundaryEnabled)&&n.withErrorBoundary?n.withErrorBoundary("Ajax.onSuccess",function(){return p(t,f)},"Ajax ".concat(v)):p(t,f)}}else--g>0?(u.abort(),ut(),u.send(w)):(e=n.getError(u.status),o="Ajax call failed with status ".concat(u.status,". No retries available."),(n.context===null||n.context===void 0?void 0:n.context.isErrorBoundaryEnabled)&&n.withErrorBoundary?n.withErrorBoundary("Ajax.onAjaxError",function(){return h(u.status,e,u.responseText,o)},"Ajax ".concat(v)):h(u.status,e,u.responseText,o))};u.send(w)}}function i(n){return n===null?null:n===undefined?undefined:typeof n=="number"||typeof n=="string"||typeof n=="boolean"?n:Array.isArray(n)?n.map(i):Object.keys(n).reduce(function(t,r){var u="".concat(r[0].toUpperCase()).concat(r.slice(1));return t[u]=typeof n[r]=="object"?i(n[r]):n[r],t},{})}function s(){return typeof window=="undefined"||!window.navigator||!window.navigator.userAgent?!1:window.navigator.userAgent.indexOf("PhantomJS")>-1}var t=n.context&&n.context,u=t===null||t===void 0?void 0:t.isThrottlingEnabled,f=(t===null||t===void 0?void 0:t.wsb)||(t===null||t===void 0?void 0:t.miniSerp),e=t===null||t===void 0?void 0:t.miniSerp;n.sendAjax=o}(BingAtWork||(BingAtWork={}));BingAtWork.Wsb=BingAtWork.Wsb||{};BingAtWork.Wsb.sendAjax=function(n,t,i){return BingAtWork.sendAjax(n,i,t)},function(n){var t;(function(t){function i(t,i,r){var u=n.getRequestMetadata(t,r);return n.mergeArgsIntoUrl(i,u)}function r(t,i,r,u,f,e,o){var s={url:t,accessToken:e,requestType:"POST",body:JSON.stringify(i),timeout:u,headers:f,onSuccess:r.onSuccess,onError:r.onError};n.augmentMsbMtAjax(s,"caller: sendPostRequest, file: ServiceHelpers");n.sendAjax(s,"caller: sendPostRequest, file: ServiceHelpers",o)}t.addArgsToUrl=i;t.sendPostRequest=r})(t=n.Service||(n.Service={}))}(BingAtWork||(BingAtWork={}));__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},function(n){var t;(function(t){var i=function(){function t(t,i){var u=this,r;this.delayNotificationRequestMilliseconds=2500;this.isActionPending=!1;this.pendingRequest=null;this.config=t;this.userData=i;this.userDataApiUrl="".concat(t.apiUriBase).concat(t.userDataApiUri);r=t.flights&&!n.isEmpty(t.flights)?",".concat(encodeURIComponent(t.flights.join())):"";this.userDataDebugApiUrl=t.userDataDebugApiUri?"".concat(t.apiUriBase).concat(t.userDataDebugApiUri,"?variants=testenabled").concat(r):undefined;this.firePendingRequest=this.firePendingRequest.bind(this);this.notificationsApiUrl="".concat(this.userDataApiUrl,"/notifications");this.cvid=typeof _G!="undefined"?_G.IG:undefined;_w.addEventListener("beforeunload",function(){return u.firePendingRequest()})}return t.prototype.notificationAction=function(n,t){this.notificationActionBatch([n],t)},t.prototype.firePendingRequest=function(){var n=this.pendingRequest;this.pendingRequest=null;this.isActionPending=!1;n&&this.notificationActionBatch(n.actions,n.onResponse)},t.prototype.notificationActionBatch=function(t,i){var r=this;if(t!=null&&t.length!==0){if(this.isActionPending){this.addToPending(t,i);return}this.isActionPending=!0;this.addToPending(t,i);setTimeout(function(){var n=r.pendingRequest,i=n.actions,t;r.pendingRequest=null;t={onSuccess:function(t){try{n.onResponse&&n.onResponse.onSuccess&&n.onResponse.onSuccess(t)}finally{r.firePendingRequest()}},onError:function(t){try{n.onResponse&&n.onResponse.onError&&n.onResponse.onError(t)}finally{r.firePendingRequest()}}};r.notificationRequest(t,{actions:i})},this.delayNotificationRequestMilliseconds)}},t.prototype.addToPending=function(n,t){if(this.pendingRequest==null){this.pendingRequest={actions:n,onResponse:t};return}if(this.pendingRequest.actions=this.pendingRequest.actions.concat(n),t){var i=this.pendingRequest.onResponse&&this.pendingRequest.onResponse.onSuccess,r=this.pendingRequest.onResponse&&this.pendingRequest.onResponse.onError;t.onSuccess&&(i=i?function(n){i(n);t.onSuccess(n)}:t.onSuccess);t.onError&&(r=r?function(n){r(n);t.onError(n)}:t.onError);this.pendingRequest.onResponse={onSuccess:i,onError:r}}},t.prototype.clear=function(t,i){var r={url:t?"".concat(this.userDataApiUrl,"/notifications"):this.userDataApiUrl,requestType:"DELETE",onSuccess:i&&i.onSuccess||function(){console.log("UserDataClient: succeed to clear user data")},onError:i&&i.onError||function(){console.log("UserDataClient: fail to clear user data")}};n.sendAjax(r,"caller: clear, file: UserDataVNextClient")},t.prototype.getUserData=function(t){if(this.userDataDebugApiUrl){var i={url:this.userDataDebugApiUrl,requestType:"GET",onSuccess:t&&t.onSuccess||function(n){console.log("UserDataClient: Current UserData: ".concat(n));console.log(n)},onError:t&&t.onError||function(n,t,i){console.log("UserDataClient: fail to GetUserData, reason:".concat(n,", statusCode:").concat(t,", response:").concat(i," "))}};n.sendAjax(i,"caller: clear, file: UserDataVNextClient")}else throw new Error("GetUserData not permitted for the current user");},t.prototype.setUserData=function(t,i){if(this.userDataDebugApiUrl){var r=JSON.stringify(t),u={url:this.userDataDebugApiUrl,requestType:"POST",body:r,onSuccess:i&&i.onSuccess||function(){console.log("UserDataClient: successfully updated UserData")},onError:i&&i.onError||function(n,t,i){console.log("UserDataClient: fail to SetUserData, reason:".concat(n,", statusCode:").concat(t,", response:").concat(i," "))}};n.sendAjax(u,"caller: clear, file: UserDataVNextClient")}else throw new Error("SetUserData not permitted for the current user");},t.prototype.notificationRequest=function(t,i){var r,u,f;i===void 0&&(i=null);r={};this.cvid!==undefined&&(r.cvid=this.cvid);u="".concat(this.userDataApiUrl,"/notifications");f="PUT";this.config.notificationDataUpdateApiUri&&(u="".concat(this.config.apiUriBase).concat(this.config.notificationDataUpdateApiUri),f="POST");var o=n.getRequestMetadata(this.config,r),s=n.mergeArgsIntoUrl(u,o),h=function(r,u){if(sj_evt.fire("bfbUpdateNotifications",r,i,u,!1,n.getSucceededEventDetails(r,u,!1)),t&&t.onSuccess)t.onSuccess(r)},c=function(i,r,u){if(sj_evt.fire("bfbUpdateNotifications_Failed",i,r,u,n.getFailedEventDetails(i,r)),t&&t.onError)t.onError(i)},e={url:s,timeout:this.config.userDataTimeout,onSuccess:h,onError:c};e.body=JSON.stringify(i);e.requestType=f;sj_evt.fire("bfbUpdateNotifications_Started",n.getStartedEventDetails());n.sendAjax(e,"caller: notificationRequest, file: UserDataVNextClient")},t.prototype.getNotifications=function(t,i){var r={};this.cvid!==undefined&&(r.cvid=this.cvid);var f=__assign({},n.getRequestMetadata(this.config,r)),e=n.mergeArgsIntoUrl(this.notificationsApiUrl,f),o=JSON.stringify(t),u={url:e,requestType:"POST",body:o,timeout:this.config.userDataTimeout,onSuccess:i&&i.onSuccess,onError:i&&i.onError};n.augmentMsbMtAjax(u,"caller: getNotifications, file: UserDataVNextClient");this.cachedRequest=t;sj_evt.fire("bfbGetNotifications_Started",n.getStartedEventDetails());n.sendAjax(u,"caller: getNotifications, file: UserDataVNextClient")},t.prototype.broadcast=function(n){this.cachedNotificationResponse=n;this.broadcastImpl()},t.prototype.broadcastImpl=function(){sj_evt.fire("bfbGetNotifications",this.cachedNotificationResponse,this.cachedRequest,n.getSucceededEventDetails(this.cachedNotificationResponse,null,!1))},t}();t.UserDataVNextClient=i})(t=n.Service||(n.Service={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){var i=function(){function t(){var t=localStorage.getItem("UserData");if(t!=null)try{this.localUserData=JSON.parse(t)}catch(i){this.isInvalid=!0}this.localUserData==null&&(this.localUserData={notifications:[]})}return t.prototype.isValid=function(){return!this.isInvalid},t.prototype.getNotificationInfo=function(n,t){var i,r,u;if(this.isInvalid)return null;if(i=this.localUserData.notifications[n],i!=null)if(t>0&&i.lastImpressionTimestamp){if(r=(new Date).getTime(),u=(r-i.lastImpressionTimestamp)/1e3,u<t)return i}else return i;return this.localUserData.notifications[n]={impressionCount:0,suppressedCount:0,dismissedCount:0},this.localUserData.notifications[n]},t.prototype.logNotificationAction=function(t,i){if(!this.isInvalid){var r=this.getNotificationInfo(t,0),u=(new Date).getTime();switch(i){case 0:r.impressionCount++;r.firstImpressionTimestamp==null&&(r.firstImpressionTimestamp=u);r.lastImpressionTimestamp=u;break;case 3:r.suppressedCount++;break;case 2:r.dismissedTimestamp=u;r.dismissedCount==null?r.dismissedCount=1:r.dismissedCount++;break;default:return}localStorage.setItem("UserData",JSON.stringify(this.localUserData))}},t.prototype.clear=function(){localStorage.removeItem("UserData")},t}();t.LocalUserDataClient=i})(t=n.Service||(n.Service={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){var i=function(){function i(t,i,r){var u=this;this.enabled=function(n){return!u.notificationSystemCfg.e||!n.cfg.e?0:n.cfg.mustHaveAssignments?u.mustHaveAssignments(n):n.cfg.mustHaveClasses?u.mustHaveClasses(n):n.cfg.mustNotHaveAssignments?u.mustNotHaveAssignments(n):null};this.forced=function(n){return n.forced&&n.forcedNotifKind!=null?n.forcedNotifKind===n.kind?1:0:null};this.dismissed=function(n){if(n.cfg.maxDismissals&&n.cfg.timeIntervalBetweenDismissalsInSec){if(n.info.dismissedCount&&n.info.dismissedCount>=n.cfg.maxDismissals)return 0;if(n.info.dismissedTimestamp){var t=(new Date).getTime(),i=(t-n.info.dismissedTimestamp)/1e3;return i<n.cfg.timeIntervalBetweenDismissalsInSec?0:null}return null}return n.info.dismissedTimestamp?0:null};this.maxImpressionsAndInterval=function(n){if(n.cfg.maxImps&&n.info.impressionCount>=n.cfg.maxImps)return 0;if(n.cfg.timeIntervalBetweenImpressionsInSec&&n.info.lastImpressionTimestamp){var t=(new Date).getTime(),i=(t-n.info.lastImpressionTimestamp)/1e3;if(i<n.cfg.timeIntervalBetweenImpressionsInSec)return 0}return null};this.autoSignedIn=function(n){var t=n.cfg,i=n.ssoSucceeded,r=n.autoSignedIn;return t.mustBeAutoSignedIn?i&&r?null:0:null};this.msaSignedIn=function(n){var t=n.cfg,i=n.hasMsa;return t.mustBeMsaSignedIn&&!i?0:null};this.signedOut=function(n){var t=n.cfg,i=n.hasMsa,r=n.ssoSucceeded;return t.mustBeAadSignedIn?null:!t.mustBeAutoSignedIn&&!t.mustBeMsaSignedIn&&!t.mustBeUpsell?i||r?0:null:void 0};this.isUpsell=function(n){var t=n.cfg,i=n.isUpsell;return t.mustBeUpsell&&!i?0:null};this.isRewards=function(n){var i=n.cfg,t;return i.mustBeRewards&&i.mustBeAadSignedIn?(t=sj_cook.get("_RwBf","e"),t&&t.length>1?null:0):null};this.show=function(){return 1};this.notificationSystemCfg=n.chk(t,0);this.localUserDataClient=n.chk(i,1);this.controllerOptions=r;this.notificationRules=[this.enabled,this.forced,this.dismissed,this.maxImpressionsAndInterval,this.autoSignedIn,this.msaSignedIn,this.signedOut,this.isRewards,this.isUpsell,this.show]}return i.prototype.decide=function(i,r,u,f,e){var a=null,y=[],p=this.notificationSystemCfg,k=p.forced,d=p.forcedNotifKind,w,c,v,b,l;if(this.localUserDataClient.isValid())for(w in this.notificationSystemCfg.clientNotifications){var o=n.enumPropertyToValue(w,t.NotificationKind),s=this.notificationSystemCfg.clientNotifications[o],g=this.localUserDataClient.getNotificationInfo(o,s.lookBackIntervalForRuleValidation),h=0;for(c=0,v=this.notificationRules;c<v.length;c++){if(b=v[c],l=b({kind:o,cfg:s,info:g,ssoSucceeded:i,autoSignedIn:r,forced:k,forcedNotifKind:d,hasMsa:u,isUpsell:f,userConfigResponse:e}),l!=null){l===1&&a==null?a=this.buildNotification(o,s,1):l===2&&y.push(this.buildNotification(o,s,2));break}h++}}return{shown:a,suppressed:y}},i.prototype.buildNotification=function(t,i,r){var o=i.renderMode,s=i.targetElementId,h=i.alignment,c=i.titleStrKey,l=i.bodyStrKey,a=i.actionBtns,v=i.showPrivacyFtr,y=i.headerImg,p=i.renderAgg,w=i.useThemeRunner,b=i.popupWidth,k=i.popupOffset,d=i.popupArrowOffset,g=i.popupPadding,nt=i.useExpQries,tt=i.maxQueries,it=i.isUnVNext,rt=i.showUserInfo,st=i.mustBeRewards,ut=i.mustBeUpsell,f=i.externalLink,e=i.externalLabelKey,ft=i.isSerpSSOAdminThemeEnabled,u=i.configuredQueries,et=i.titleIconKey,ot=i.treatmentVariation;return{notifyKind:t,behavior:r,renderMode:o,targetElementId:s,alignment:h,title:n.Strings[c],body:n.Strings[l],actionBtns:this.buildActionButtons(a,ut,e,f),showPrivacyFtr:v,headerImg:y,renderAgg:p,useThemeRunner:w,popupWidth:b,popupOffset:k,popupArrowOffset:d,popupPadding:g,externalLink:f,externalLabelKey:e,useExpQries:nt,maxQueries:tt,isUnVNext:it,showUserInfo:rt,isSerpSSOAdminThemeEnabled:ft,configuredQueries:u===null||u===void 0?void 0:u.map(function(t){return n.Strings[t]}),titleIconKey:et,treatmentVariation:ot}},i.prototype.buildActionButtons=function(t,i,r,u){var e=this,f=[];return t.forEach(function(t){switch(t){case 2:f.push({label:n.Strings.NotifyActionLabel_Sso_GotIt,target:"GOTIT",isHighlighted:!0});break;case 3:f.push({label:n.Strings.NotifyActionLabel_Sso_SignOut,target:"SIGNOUT"});break;case 0:f.push({label:n.Strings.NotifyActionLabel_SignIn,target:"SIGNIN",isHighlighted:!0,url:i?e.controllerOptions.signInUpsellLink:e.controllerOptions.signInLink});break;case 1:f.push({label:n.Strings.NotifyActionLabel_LearnMore,target:"LEARN",url:e.controllerOptions.learnLink});break;case 4:f.push({label:n.Strings.NotifyActionLabel_SwitchAccounts,target:"SWITCHACCOUNTS",isHighlighted:!0,url:i?e.controllerOptions.signInUpsellLink:e.controllerOptions.signInLink});break;case 5:f.push({label:n.Strings.NotifyActionLabel_EhpNoThanks,target:"EHPNOTHANKS"});break;case 6:f.push({label:n.Strings.NotifyActionLabel_EhpSoundsGreat,isHighlighted:!0,target:"GOTIT"});break;case 8:f.push({label:n.Strings.NotifyActionLabel_MaybeLater,target:"MAYBELATER"});break;case 9:f.push({label:n.Strings.NotifyActionLabel_Unlink,target:"UNLINK"});break;case 7:e.validateExternalButtonOptions(r,u)&&f.push({label:n.Strings[r],target:"EXTACTION",url:u})}}),f},i.prototype.validateExternalButtonOptions=function(t,i){return i?t?!0:!1:!1},i.prototype.mustNotHaveAssignments=function(n){return n&&n.userConfigResponse&&n.userConfigResponse.eduSettings&&!n.userConfigResponse.eduSettings.hasAssignments?null:0},i.prototype.mustHaveAssignments=function(n){return n&&n.userConfigResponse&&n.userConfigResponse.eduSettings&&n.userConfigResponse.eduSettings.hasAssignments?null:0},i.prototype.mustHaveClasses=function(n){return n&&n.userConfigResponse&&n.userConfigResponse.eduSettings&&n.userConfigResponse.eduSettings.hasClasses?null:0},i}();t.ClientNotificationEngine=i})(t=n.UserNotification||(n.UserNotification={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){function u(u,e,c,l,a,v,y,p,w,b,k){var lt,ut,ft;if(u!=null){var et=u,ii=u,nt=u.title,g=u.headerImg,st=u.actionBtns,yt=u.showPrivacyFtr,it=u.notifyKind,ri=u.useExpQries,ui=u.queries,fi=u.maxQueries,pt=u.isUnVNext,tt=u.isSerpSSOAdminThemeEnabled,ht=u.configuredQueries,rt=null,wt=!1;ri?rt=ui:(ht===null||ht===void 0?void 0:ht.length)>0&&(wt=!0,rt=ht);var ei="bw-unNot"+((lt=it===null||it===void 0?void 0:it.toString())===null||lt===void 0?void 0:lt.toLowerCase()),at=et.body,ot=et.useThemeRunner,oi=et.popupOffset,si=et.popupWidth,bt=et.titleIconKey,kt=ii.qryLbl,hi="R5FZeTI5Afc9NBRK7GHAzPkr1vHbc/X2n1c+mPVUhzE=",ct=c||"#0078D4",dt="#FFFFFF",vt="#111111";l&&tt&&(dt="#"+l[1],vt="#"+l[2]);l&&(ct="#"+l[0]);ut=null;ft=null;switch(u.alignment){case 1:ut="bw-unTopLft";ft="bw-unArwTop bw-unArwTopLft";break;case 2:ut="bw-unTopRt";ft="bw-unArwTop bw-unArwTopRt";break;case 3:ut="bw-unLftTop";ft="bw-unArwLftTop";break;case 4:ut="bw-unAcctRt";ft="bw-unArwTop bw-unArwAcctRt"}var ci=e===1?"bw-unSerp":"bw-unHomepg",li="b_hide ".concat(ut," ").concat(ci," ").concat(ei),d=sj_ce("div",pt?"bw-un-vnext":"bw-un",li);d.setAttribute("data-priority","2");d.setAttribute("tabindex","0");var gi=function(){var n=sj_ce("div",null,"bw-unThmRnr");return n.style.backgroundColor=ct,n},ai=function(t){var i=sj_ce("a",null,"bw-unDis");return t&&i.classList.add(t),i.title=n.Strings.Dismiss,i.setAttribute("role","button"),i.setAttribute("tabindex","0"),i.appendChild(vi(vt)),i},vi=function(n){return r("M12 0.691L6.699 6L12 11.309L11.309 12L6 6.699L0.691 12L0 11.309L5.301 6L0 0.691L0.691 0L6 5.301L11.309 0L12 0.691Z","bw-unDisSVG",n)},yi=function(){var n=sj_ce("div",null,"bw-unBottomCnt"),t=sj_ce("div",null,"bw-unActs");return tt&&(n.style.backgroundColor="#F5F5F5",n.style.paddingLeft="16px"),t.innerHTML=i(st,v,c,!0,tt),n.appendChild(t),n},pi=function(t){var i=sj_ce("a",null,"bw-unDis");return t&&i.classList.add(t),i.title=n.Strings.Dismiss,i.setAttribute("role","button"),i.setAttribute("tabindex","0"),i.innerHTML='<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKBAMAAAB/HNKOAAAAIVBMVEX///9VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVW83/q/AAAAC3RSTlMANzo9QEK9v+Ln7AfYsJ8AAAA7SURBVAgdY0hlYGAIY5AMYGCdyMA4hSFSgIFBQnQiUJB5lgKQZF0VACSjQpcCmUsZogJACMgoBQqGAwAVzQn7WBRrIQAAAABJRU5ErkJggg==" alt="'.concat(n.Strings.Dismiss,'" />'),i},wi=function(){var n=sj_ce("div",null,"bw-unHeaderCnt");return n.appendChild(ai(g?"bw-unShiftUp":ot?"bw-unShiftDn":undefined)),y&&n.appendChild(gt()),g&&(n.appendChild(sj_ce("div",null,"bw-unHdrImg bw-".concat(g))),n.appendChild(sj_ce("div",null,"bw-unHdrImgShdw"))),tt&&(n.style.backgroundColor=dt),n},gt=function(){var t=sj_ce("div",null,"bw-unLogo"),u,r,i;return g&&t.classList.add("bw-unShiftUp"),u=k&&k===hi?b&&(b.length<3||b.length>40):!0,u?(r=sj_ce("img"),r.src=p?y:n.getImageSrcFromBase64String(y),t.appendChild(r)):(i=sj_ce("div",null,"bw-unTextLogo"),i.innerText=b,i.style.color=vt,t.appendChild(i)),t},ni=function(){var n=sj_ce("div",null,"bw-unTtl"),i,u;if(tt&&(n.style.marginTop="8px"),it===t.NotificationKind.SsoSucceeded)if(i=nt.indexOf("{"),i>=0){u=i+3;n.innerText=nt.substring(0,i);var r=sj_ce("span",null,"bw-unTtl-tNamePart"),f=sj_ce("span",null,"bw-unTtl-tName"),e=sj_ce("span",null,"bw-unTtl-postfix");f.innerText=b;e.innerText=nt.substring(u,nt.length);r.appendChild(f);r.appendChild(e);n.appendChild(r)}else n.innerText=nt;else n.innerText=nt;return n},ti=function(){var n=sj_ce("div",null,"bw-unBdy");return n.innerText=at,yt&&n.appendChild(bi()),n},bi=function(){var t=sj_ce("div"),i;return t.innerText=n.Strings.NotifyBody_Sso_PrivateMessage,i=sj_ce("div"),i.innerHTML=tt?'\n                <a href="'.concat(a,'">').concat(n.Strings.LearnMore,"<\/a>\n            "):'\n                <svg xmlns="http://www.w3.org/2000/svg" width="10" height="12" viewBox="0 0 10 12" fill="none">\n                    <path d="M9.5 5.3V12H0.5V5.3H2V3.1C2 2.6 2.1 2.2 2.2 1.9 2.4 1.5 2.6 1.2 2.9 0.9 3.1 0.6 3.4 0.4 3.8 0.2 4.2 0.1 4.6 0 5 0 5.4 0 5.8 0.1 6.2 0.2 6.6 0.4 6.9 0.6 7.1 0.9 7.4 1.2 7.6 1.5 7.8 1.9 7.9 2.2 8 2.6 8 3.1V5.3H9.5ZM2.8 5.3H7.3V3.1C7.3 2.7 7.2 2.4 7.1 2.2 7 1.9 6.8 1.6 6.6 1.4 6.4 1.2 6.2 1.1 5.9 0.9 5.6 0.8 5.3 0.8 5 0.8 4.7 0.8 4.4 0.8 4.1 0.9 3.8 1.1 3.6 1.2 3.4 1.4 3.2 1.6 3 1.9 2.9 2.2 2.8 2.4 2.8 2.7 2.8 3.1V5.3Z" fill="#919191"/>\n                <\/svg>\n                <a href="'.concat(a,'">').concat(n.Strings.LearnMore,"<\/a>\n            "),t.appendChild(i),t},ki=function(){var n=sj_ce("div",null,"bw-unAdminTopCnt");return n.appendChild(ni()),n.appendChild(ti()),n},di=function(){var n=sj_ce("div",null,"bw-unTopCnt");return y&&n.appendChild(gt()),g&&(n.appendChild(sj_ce("div",null,"bw-unHdrImg bw-${headerImg}")),n.appendChild(sj_ce("div",null,"bw-unHdrImgShdw"))),n.appendChild(ni()),n.appendChild(ti()),n};return pt?(tt?(d.style.border="1px solid #DDDDDD",d.appendChild(wi()),d.appendChild(ki())):(d.appendChild(pi(g?"bw-unShiftUp":ot?"bw-unShiftDn":undefined)),d.appendChild(di())),d.appendChild(yi())):d.innerHTML="\n                ".concat(ot?'<div class="bw-unThmRnr" style="background-color:'.concat(ct,'"><\/div>'):"",'\n                <div class="').concat(ft,'">\n                    ').concat(o(ot?ct:null),'\n                <\/div>\n                <a class="bw-unDis ').concat(g?"bw-unShiftUp":ot?"bw-unShiftDn":""," ").concat(it===t.NotificationKind.SpotlightInfoBubble?"bw-unShiftRt":"",'" title="').concat(n.Strings.Dismiss,'" role="button" tabindex="0">\n                    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKBAMAAAB/HNKOAAAAIVBMVEX///9VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVW83/q/AAAAC3RSTlMANzo9QEK9v+Ln7AfYsJ8AAAA7SURBVAgdY0hlYGAIY5AMYGCdyMA4hSFSgIFBQnQiUJB5lgKQZF0VACSjQpcCmUsZogJACMgoBQqGAwAVzQn7WBRrIQAAAABJRU5ErkJggg==" alt="').concat(n.Strings.Dismiss,'" />\n                <\/a>\n                <div class="bw-unCnt">\n                    ').concat(y?'<div class="bw-unLogo '.concat(g?"bw-unShiftUp":"",'">\n                        ').concat(p?"<img src=".concat(y," />"):"<img src=".concat(n.getImageSrcFromBase64String(y)," />"),"\n                    <\/div>"):"","\n                    ").concat(g?'<div class="bw-unHdrImg bw-'.concat(g,'"><\/div>\n                        <div class="bw-unHdrImgShdw"><\/div>'):"",'\n                    <div class="bw-unTtl">').concat(h(nt)).concat(bt?'<div class="bw-unTtlIcn"><img src='.concat(bt," /><\/div>"):"",'<\/div>\n                    <div class="bw-unBdy">\n                        ').concat(at?'<div class="bw-unBdyTxt">'.concat(at,"<\/div>"):"","\n                        ").concat((rt===null||rt===void 0?void 0:rt.length)>0?"".concat(kt?'<div class="bw-unQrLbl">'.concat(kt,"<\/div>"):"",'\n                        <ul class="bw-unQrList">').concat(f(rt,fi,c,w,it,wt),"<\/ul>"):"","\n                    <\/div>\n                    ").concat(st&&st.length>0?'<div class="bw-unActs">\n                            '.concat(i(st,v,c),"\n                        <\/div>"):"","\n                    ").concat(yt?'<div class="bw-unFtr">\n                            <span>'.concat(s(n.Strings.PrivacyFooter,a),"<\/span>\n                        <\/div>"):"","\n                <\/div>\n            "),u.alignment==4&&(d.style.marginLeft="".concat(oi,"px"),d.style.width="".concat(si,"px")),d}}function f(n,t,i,r,u,f){var o=[],s;return n&&(s=0,n.slice(0,t).forEach(function(n){var t=e(n,i,r,"B4BUN",u,f);o.push(t.outerHTML)})),o.join("")}function e(t,i,r,u,f,e){var s=sj_ce("li"),l=n.strFormat(r,u,f,encodeURIComponent(t)),o=sj_ce("a",null,"bw-expQryLnk"),h;return o.href=l,o.target="_blank",o.innerText=t,i&&(o.style.color=i),e&&(h=c(i),o.prepend(h)),s.appendChild(o),s}function o(n){var i=n||"#f9f9f9",t=n||"#ccc";return'\n            <svg class="bw-ttipArwSvg" viewBox="0 0 13 10">\n                <g fill="transparent" stroke="'.concat(t,'" stroke-opacity="0.33" stroke-width="0.667">\n                    <path d="M0,0 L6.5,9.1 L14,0"><\/path>\n                <\/g>\n                <g fill="transparent" stroke="').concat(t,'" stroke-opacity="0.67" stroke-width="0.667">\n                    <path d="M-1,0.05 L6.5,9.1 L14,0.05"><\/path>\n                <\/g>\n                <g fill="').concat(i,'" stroke="').concat(t,'">\n                    <path d="M0,0 L6.5,8 L13,0"><\/path>\n                <\/g>\n            <\/svg>')}function i(n,t,i,r,u){var f="";return n.forEach(function(n){var e=n.target==="SIGNOUT",o;e&&(f+='<form id="bw-unSnOtFrm" action="'.concat(t,'" method="post">'));o=n.target==="GOTIT";f+="<a ".concat(n.url?'href="'.concat(n.url,'"'):"","\n                    ").concat(n.isHighlighted?'style="background-color: '.concat(r?"#0078D4":i,'"'):"",'\n                    class="bw-unActBtn bw-unActBtn').concat(n.target," ").concat(n.isHighlighted?"bw-unActBtnDef":"bw-unActBtnOth"," ").concat(r&&u&&o?"bw-unActBtnSmallRnd":""," ").concat(r&&!u?"bw-unActBtnRnd":"",'"\n                    title="').concat(n.label,'"\n                    role="button"\n                    tabindex="0">\n                    ').concat(n.label,"\n                <\/a>");e&&(f+="<\/form>")}),f}function s(n,t){if(!n)return null;var u='<a href="'.concat(t,'" target="_blank" class="bw-unLnk">'),f="<\/a>",i="{",r="}",e=n.indexOf(i),o=n.indexOf(r);return e>=0&&o>=0&&e<o?n.replace(i,u).replace(r,f):u+n.replace(i,"").replace(r,"")+f}function h(n){if(n){var t=n.split("\n");return"<span>".concat(t.map(function(n,i){return"<span key=".concat(i,">").concat(n).concat(i<t.length-1?"<br/>":"","<\/span>")}).join(""),"<\/span>")}}function c(n){var i=n||"#1A0DAB",t=r("M8.5 3C11.5376 3 14 5.46243 14 8.5C14 9.74832 13.5841 10.8995 12.8834 11.8226L17.0303 15.9697C17.3232 16.2626 17.3232 16.7374 17.0303 17.0303C16.7641 17.2966 16.3474 17.3208 16.0538 17.1029L15.9697 17.0303L11.8226 12.8834C10.8995 13.5841 9.74832 14 8.5 14C5.46243 14 3 11.5376 3 8.5C3 5.46243 5.46243 3 8.5 3ZM8.5 4.5C6.29086 4.5 4.5 6.29086 4.5 8.5C4.5 10.7091 6.29086 12.5 8.5 12.5C10.7091 12.5 12.5 10.7091 12.5 8.5C12.5 6.29086 10.7091 4.5 8.5 4.5Z","bw-unSrchGlIcn",i);return t.setAttribute("width","20"),t.setAttribute("height","20"),t.setAttribute("viewBox","0 0 20 20"),t}function r(n,t,i){var f="http://www.w3.org/2000/svg",u=document.createElementNS(f,"svg"),r;return t&&u.setAttribute("class",t),r=document.createElementNS(f,"path"),r.setAttribute("d",n),i&&r.setAttribute("fill",i),u.appendChild(r),u}t.createPopup=u})(t=n.UserNotification||(n.UserNotification={}))}(BingAtWork||(BingAtWork={})),function(n){function i(n){var i=t(n);return"".concat(i,";base64,").concat(n)}function t(n){var t=n&&n.length>0?n.charAt(0):"i";switch(t){case"/":return"data:image/jpeg";case"P":return"data:image/svg+xml";case"i":default:return"data:image/png"}}n.getImageSrcFromBase64String=i;n.getMimeType=t}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){function e(t,i,r,u,f,e,l,a,v,y,p,w,b,k){var g;if(t){var tt=t.actionBtns,nt=t.treatmentVariation,d=sj_ce("div","bw-un-vnext-overlay","b_hide bw-unAcctRt bw-unSerp");if(nt>0&&d.appendChild(o(r,u,i,f,e)),d.appendChild(s(a,v,b,p,w,y,k,nt)),d.appendChild(h(i,nt)),g=tt&&tt[0],g&&g.url)return d.appendChild(c(g,l)),d}}function o(t,r,e,o,s){var l=sj_ce("div",null,i.tenantHeaderContainer),a=sj_ce("div",null,i.tenantHeaderIconDiv),v=l,y=a,p,h,c;return e&&o&&t&&(p=r&&r===f?e&&e.length<3:!0,v.style.background=s&&s.length>1?"#"+s[1]:o,p?(h=sj_ce("img",null,i.tenantHeaderIcon),h.src=n.getImageSrcFromBase64String(t),h.setAttribute("aria-label",e),h.alt=e,y.appendChild(h)):(c=sj_ce("h4",null,i.tenantHeaderText),c.innerText=e,c.style.color=s&&s.length>2?"#"+s[2]:"#fff",y.appendChild(c),c.title=e)),l.appendChild(a),l.appendChild(u(v.style.background,"white")),l}function s(n,t,f,e,o,s,h,c){var a=sj_ce("div",null,i.headerContainer),l=sj_ce("div",null,i.swoopContainer);return l.appendChild(r(n,"".concat(i.swoopImage))),l.appendChild(r(h,"".concat(i.iconsCommon," ").concat(i.excelImage," ").concat(i.leanRightCommon))),l.appendChild(r(f,"".concat(i.iconsCommon," ").concat(i.avatar1Image," ").concat(i.leanLeftCommon))),l.appendChild(r(e,"".concat(i.iconsCommon," ").concat(i.wordImage," ").concat(i.leanLeftCommon))),l.appendChild(r(t,"".concat(i.iconsCommon," ").concat(i.sharepointImage," ").concat(i.leanRightCommon))),l.appendChild(r(o,"".concat(i.iconsCommon," ").concat(i.powerpointImage," ").concat(i.leanLeftCommon))),l.appendChild(r(s,"".concat(i.iconsCommon," ").concat(i.avatar2Image," ").concat(i.leanRightCommon))),c||l.appendChild(u()),a.appendChild(l),a}function r(n,t){var i=sj_ce("img");return i.src=n,i.setAttribute("class",t),i.alt="",i}function u(t,r){var f=sj_ce("button",null,i.dismiss),u,e;return f.setAttribute("title",n.Strings.Dismiss),t&&(f.style.background=t),u=_d.createElementNS("http://www.w3.org/2000/svg","svg"),u.setAttribute("width","12"),u.setAttribute("height","12"),u.setAttribute("viewBox","0 0 12 12"),u.setAttribute("title",n.Strings.Dismiss),e=_d.createElementNS("http://www.w3.org/2000/svg","path"),e.setAttribute("d","M12 0.7L6.7 6 12 11.3 11.3 12 6 6.7 0.7 12 0 11.3 5.3 6 0 0.7 0.7 0 6 5.3 11.3 0 12 0.7Z"),e.setAttribute("fill",r!==null&&r!==void 0?r:"#666"),u.appendChild(e),f.appendChild(u),f}function h(t,r){var e=sj_ce("div",null,i.textContainer),u=sj_ce("div",null,i.searchOnBing),f,o,s;return u.setAttribute("role","heading"),u.setAttribute("aria-level","2"),f=sj_ce("div",null,i.speedySearch),r>0?(o=r===1?n.Strings.WorkSearchText1:n.Strings.WorkSearchText2,u.innerText=o,s=n.Strings.WorkSearchTextMain,f.innerHTML=s):(u.innerText=n.strFormat(n.Strings.SearchCompanyNameOnBing,t),f.innerText=n.Strings.SpeedySearchText),e.appendChild(u),e.appendChild(f),e}function c(n,t){var r=sj_ce("div",null,i.signInContainer);return r.appendChild(l(n,t)),r}function l(t,r){var u=sj_ce("a",null,i.signInButton);return u.classList.add("".concat(i.signInButton).concat(t.target)),u.href=t.url,u.title=t.label,u.tabIndex=0,u.innerText=r?n.Strings.SwitchToYourWork:n.Strings.SignInToWork,u}var i={dismiss:"bw-unDis",textContainer:"bw-unTextContainer",searchOnBing:"bw-unSearchOnBing",speedySearch:"bw-unSpeedySearch",signInContainer:"bw-unActs",signInButton:"bw-unActBtn",headerContainer:"bw-unHeader",tenantHeaderContainer:"bw-unTenanatHeader",tenantHeaderIcon:"bw-unTenanatHeaderIcon",tenantHeaderText:"bw-unTenanatHeaderText",tenantHeaderIconDiv:"bw-unTenanatHeaderDiv",swoopContainer:"bw-unSwoop",swoopImage:"bw-unSwoopimage",iconsCommon:"bw-unIcon",excelImage:"bw-unExcel",leanRightCommon:"bw-unLeanRight",leanLeftCommon:"bw-unLeanLeft",sharepointImage:"bw-unSharepoint",wordImage:"bw-unWord",powerpointImage:"bw-unPowerpoint",avatar1Image:"bw-unAvatar1",avatar2Image:"bw-unAvatar2"},f="R5FZeTI5Afc9NBRK7GHAzPkr1vHbc/X2n1c+mPVUhzE=";t.createPopupForSignInUpsell=e})(t=n.UserNotification||(n.UserNotification={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){function r(t,i,r,o){if(t!=null){var l=t.actionBtns,a=t.title,v=l&&l[0],h=sj_ce("div","bw-un-vnext-footer",null);return h.appendChild(u(o)),h.appendChild(e()),h.appendChild(f(i,a)),h.appendChild(s(v,r)),h.appendChild(c()),h}}function u(n){var r=sj_ce("div",null,i.ofcContainer),t=sj_ce("img");return t.src=n,t.setAttribute("width","117px"),t.setAttribute("height","125px"),t.alt="",r.appendChild(t),r}function f(n,t){var r=sj_ce("div",null,i.message);return r.appendChild(o(n,t)),r}function e(){var r=sj_ce("div",null,i.searchIcon),n=_d.createElementNS("http://www.w3.org/2000/svg","svg"),t;return n.setAttribute("width","32"),n.setAttribute("height","32"),n.setAttribute("viewBox","0 0 32 32"),n.setAttribute("fill","none"),t=_d.createElementNS("http://www.w3.org/2000/svg","path"),t.setAttribute("d","M11 0C10 0 9 0.1 8.1 0.4 7.1 0.7 6.3 1 5.5 1.5 4.6 2 3.9 2.6 3.2 3.2 2.6 3.9 2 4.6 1.5 5.5 1 6.3 0.6 7.2 0.4 8.1 0.1 9 0 10 0 11 0 12 0.1 13 0.4 13.9 0.7 14.9 1 15.7 1.5 16.5 2 17.4 2.6 18.1 3.2 18.8 3.9 19.4 4.6 20 5.5 20.5 6.3 21 7.2 21.4 8.1 21.6 9 21.9 10 22 11 22 12.3 22 13.5 21.8 14.7 21.3 15.9 20.9 17 20.3 18 19.5L30.3 31.7C30.5 31.9 30.7 32 31 32 31.3 32 31.5 31.9 31.7 31.7 31.9 31.5 32 31.3 32 31 32 30.7 31.9 30.5 31.7 30.3L19.5 18C20.3 17 20.9 15.9 21.3 14.8 21.8 13.6 22 12.3 22 11 22 10 21.9 9 21.6 8.1 21.3 7.1 21 6.3 20.5 5.5 20 4.6 19.4 3.9 18.8 3.2 18.1 2.6 17.4 2 16.5 1.5 15.7 1 14.8 0.6 13.9 0.4 13 0.1 12 0 11 0ZM11 20C9.8 20 8.6 19.8 7.5 19.3 6.4 18.8 5.5 18.2 4.6 17.4 3.8 16.5 3.2 15.6 2.7 14.5 2.3 13.4 2 12.3 2 11 2 9.8 2.2 8.6 2.7 7.5 3.2 6.4 3.8 5.5 4.6 4.6 5.5 3.8 6.4 3.2 7.5 2.7 8.6 2.3 9.8 2 11 2 12.2 2 13.4 2.2 14.5 2.7 15.6 3.2 16.5 3.8 17.4 4.6 18.2 5.5 18.8 6.4 19.3 7.5 19.8 8.6 20 9.8 20 11 20 12.2 19.8 13.4 19.3 14.5 18.8 15.6 18.2 16.5 17.4 17.4 16.5 18.2 15.6 18.8 14.5 19.3 13.4 19.8 12.3 20 11 20Z"),t.setAttribute("fill","#0078D7"),n.appendChild(t),r.appendChild(n),r}function o(t,r){var f=sj_ce("div",null,i.textContainer),u=sj_ce("div",null,i.searchOnBing),e;return u.innerText=n.strFormat(n.Strings.SearchCompanyNameOnBing,t),u.setAttribute("role","heading"),u.setAttribute("aria-level","2"),e=sj_ce("div",null,i.speedySearch),e.innerText=r,f.appendChild(u),f.appendChild(e),f}function s(n,t){var r=sj_ce("div",null,i.signInContainer);return r.appendChild(h(n,t)),r}function h(t,r){var u=sj_ce("a",null,i.signInButton);return u.classList.add("".concat(i.signInButton).concat(t.target)),u.href=t.url||"",u.title=t.label,u.tabIndex=0,r?(u.style.padding="0px 8px",u.innerText=n.Strings.SwitchToYourWork):(u.style.padding="0px 16px",u.innerText=n.Strings.SignInToWork),u}function c(){var u=sj_ce("button",null,i.dismiss),t,r;return u.title=n.Strings.Dismiss,t=_d.createElementNS("http://www.w3.org/2000/svg","svg"),t.setAttribute("width","16"),t.setAttribute("height","16"),t.setAttribute("viewBox","0 0 16 16"),t.setAttribute("fill","none"),t.setAttribute("title",n.Strings.Dismiss),r=_d.createElementNS("http://www.w3.org/2000/svg","path"),r.setAttribute("d","M16 0.9L8.9 8 16 15.1 15.1 16 8 8.9 0.9 16 0 15.1 7.1 8 0 0.9 0.9 0 8 7.1 15.1 0 16 0.9Z"),r.setAttribute("fill","#666"),t.appendChild(r),u.appendChild(t),u}var i={dismiss:"bw-unDis",message:"bw-unMessage",searchIcon:"bw-unSearchIcon",textContainer:"bw-unTextContainer",searchOnBing:"bw-unSearchOnBing",speedySearch:"bw-unSpeedySearch",signInContainer:"bw-unActs",signInButton:"bw-unActBtn",ofcContainer:"bw-unOfc"};t.createSignInFooterUpsell=r})(t=n.UserNotification||(n.UserNotification={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){function i(t,i,h,c,l){var a,y;if(t!=null){var v=t.actionBtns,k=t.title,d=t.body,g=v&&v[0],nt=v&&v[1],tt=h?"bw-un-vnext-anaFooter":"bw-un-vnext-anaFooterNol",p=sj_ce("div",tt,null),w,b;return h&&(w=u(l),b=f()),a=sj_ce("div",null,"bw-ana-container"),y=sj_ce("div",null,"bw-ana-buttonContainer"),!c&&h&&(a.appendChild(w),a.appendChild(b)),a.appendChild(r(i)),a.appendChild(e(k,d)),c&&h&&(a.appendChild(b),a.appendChild(w)),y.appendChild(s(g)),y.appendChild(o(nt)),p.appendChild(a),p.appendChild(y),p}}function r(n){var t=sj_ce("div",null,"bw-ana-icon-container"),i=sj_ce("img");return i.src=n,t.appendChild(i),t}function u(n){var t=sj_ce("span",null,"bw-ana-dn");return t.textContent=n,t}function f(){return sj_ce("div",null,"bw-ana-div")}function e(n,t){var i=sj_ce("span",null,"bw-ana-titleContent"),u=sj_ce("span",null,"bw-ana-title"),r;return u.textContent=n,r=sj_ce("span",null,"bw-ana-subtitle"),r.textContent=t,i.appendChild(u),i.appendChild(r),i}function o(n){var r=sj_ce("div",null,"bw-unActs"),i=sj_ce("div",null,"bw-ana-download"),t;return i.classList.add("bw-unActBtn".concat(n.target)),t=sj_ce("a",null,"bw-ana-a"),t.href=n.url,t.innerText=n.label,i.appendChild(t),r.appendChild(i),r}function s(n){var t=sj_ce("div",null,"bw-ana-maybeLater bw-unDis");return t.innerText=n.label,t.setAttribute("role","button"),t}t.createAnaheimFooterUpsell=i})(t=n.UserNotification||(n.UserNotification={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(n){var t;(function(n){n[n.FirstRun=0]="FirstRun";n[n.None=1]="None";n[n.FirstRunCarousel=4]="FirstRunCarousel";n[n.SsoSucceeded=5]="SsoSucceeded";n[n.MsaSignIn=6]="MsaSignIn";n[n.SignOut=7]="SignOut";n[n.BookmarkTip=8]="BookmarkTip";n[n.FileTip=9]="FileTip";n[n.PersonTip=10]="PersonTip";n[n.GenericTip=11]="GenericTip";n[n.Welcome=12]="Welcome";n[n.MainlineFirstRun=13]="MainlineFirstRun";n[n.ScopeTab=14]="ScopeTab";n[n.VerticalFirstRun=15]="VerticalFirstRun";n[n.NoConfident=16]="NoConfident";n[n.Covid19=17]="Covid19";n[n.EnterpriseHomepageFre=18]="EnterpriseHomepageFre";n[n.IndustryNews=19]="IndustryNews";n[n.EnterpriseHomepageFreV2=20]="EnterpriseHomepageFreV2";n[n.SignoutRetention=21]="SignoutRetention";n[n.SignoutRetentionLandingPage=22]="SignoutRetentionLandingPage";n[n.SignInFooterUpsell=23]="SignInFooterUpsell";n[n.OverlaySignInUpsell=24]="OverlaySignInUpsell";n[n.AnaheimFooterUpsell=25]="AnaheimFooterUpsell";n[n.RewardsFRENotification=26]="RewardsFRENotification";n[n.SpotlightInfoBubble=27]="SpotlightInfoBubble";n[n.EduAssignSpotlightInfoBubble=28]="EduAssignSpotlightInfoBubble";n[n.EduFilesSpotlightInfoBubble=29]="EduFilesSpotlightInfoBubble";n[n.EduProfileSpotlightInfoBubble=30]="EduProfileSpotlightInfoBubble"})(t=n.NotificationKind||(n.NotificationKind={}))})(t=n.UserNotification||(n.UserNotification={}))}(BingAtWork||(BingAtWork={}));__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},function(n){var t;(function(t){t.tenantSettingsAjaxBound=n.Service.tenantSettingsAjaxBound;t.SeverSideCachedVerticalConfigExpirationInSeconds=864e5;var i=n.context||{isCacheTenantSettingsEnabled:!1,isForceRefreshTenantSettingsEnabled:!1,isErrorBoundaryEnabled:!1,tenantId:""},r=i.isCacheTenantSettingsEnabled,f=i.isForceRefreshTenantSettingsEnabled,e=i.isErrorBoundaryEnabled,u=i.tenantId,o=i.aadUserId,s=i.authorized,h=function(){function i(i,r,f){var o=this,s;this.config=i;this.onAjaxLoad=function(){u!==(o.cachedTenantSettings&&o.cachedTenantSettings.tenantObjectId)&&(n.isTenantSettingsPrefetchStarted=!1,o.getTenantSettings());o.broadcastImpl()};this.tenantSettingsApiUrl="".concat(i.apiUriBase).concat(i.tenantSettingsApiUri);this.requireM365DataBoundary=i.enableM365DataBoundary;s=function(){o.onResponse=r;t.tenantSettingsAjaxBound||(sj_evt.bind("ajax.load",o.onAjaxLoad,!0,null,!0),t.tenantSettingsAjaxBound=!0)};e&&n.withErrorBoundary?n.withErrorBoundary("TenantSettingsClientCtr",s,f):s()}return i.isValid=function(n){return!!(n&&n.tenantObjectId&&n.tenantDisplayName)},i.prototype.getTenantSettings=function(i,e){var h=this,c={onSuccess:function(t,f,e){var c,a,l,v,y;t.tenantSettings&&(r?(c=t.tenantSettings,h.requireM365DataBoundary&&(a=n.context,a.m365DataBoundary=c.m365DataBoundary==undefined||c.m365DataBoundary.length==0?["EUDB"]:c.m365DataBoundary),(c.verticalConfigs==undefined||c.verticalConfigs.length==0)&&(s&&o&&(l=c.verticalConfigs==undefined?"verticalConfigs is missing.":"verticalConfigs is empty.",n.whenWebTelemetryExists(function(){return bfbTel.logErr(n.EventScope.BingAtWork,"TenantSettingsClient: TenantSettings response missing valid verticalConfigs","".concat(l," - Will remove from localStorage"),"ClientError")})),v="bfbTenantSettings"+u,y="".concat(n.localStorageCacheKeyPrefix).concat(v),n.removeItem(y)),h.broadcast(t.tenantSettings,t.user,f,e)):h.broadcast(t.tenantSettings,t.user,f,!1),h.onResponse&&h.onResponse.onSuccess&&h.onResponse.onSuccess(t),i&&i.onSuccess&&i.onSuccess(t))},onError:function(t,r,u){if(h.requireM365DataBoundary){var f=n.context;f.m365DataBoundary=["EUDB"]}sj_evt.fire("bfbTenantSettingsFailed",t,r,u,n.getFailedEventDetails(t,r));h.onResponse&&h.onResponse.onError&&h.onResponse.onError(t,r);i&&i.onError&&i.onError(t,r);r===404&&(h.isTenantNotProvisioned=!0)}};if(r){if(n.isTenantSettingsPrefetchStarted)return;sj_evt.fire("bfbTenantSettingsStarted",n.getStartedEventDetails());n.isTenantSettingsPrefetchStarted=!0;n.withLocalStorageCache("bfbTenantSettings"+u,function(n){h.getTenantSettingsImpl(n,e)},undefined,c,function(){return new Date(Date.now()+t.SeverSideCachedVerticalConfigExpirationInSeconds)},!0,f)}else this.getTenantSettingsImpl(c,e)},i.prototype.convertToJson=function(n){if(!n)return"EmptyJSON";var t=__assign({},n);return delete t.adminEmail,delete t.exploreQueries,delete t.iconLarge,delete t.iconLargeChecksum,JSON.stringify(t)},i.prototype.getCachedTenantSettings=function(){return this.cachedTenantSettings},i.prototype.getIsTenantNotProvisioned=function(){return this.isTenantNotProvisioned},i.prototype.getTenantSettingsImpl=function(t,i){if(!r){if(n.isTenantSettingsPrefetchStarted)return;sj_evt.fire("bfbTenantSettingsStarted",n.getStartedEventDetails());n.isTenantSettingsPrefetchStarted=!0}var u=__assign(__assign({},n.getRequestMetadata(this.config)),{isLokiVerticalConfigRequired:!0}),e=__assign(__assign({},u),{IsDataBoundaryRequired:!0}),o=n.mergeArgsIntoUrl(i||this.tenantSettingsApiUrl,this.requireM365DataBoundary?e:u),f={url:o,requestType:"GET",timeout:this.config.tenantSettingsTimeout,onSuccess:t&&t.onSuccess,onError:t&&t.onError};n.augmentMsbMtAjax(f,"caller: getTenantSettings, file: TenantSettingsClient");n.sendAjax(f,"caller: getTenantSettings, file: TenantSettingsClient")},i.prototype.broadcast=function(t,r,u,f){i.isValid(t)&&(this.cachedTenantSettings=t,this.cachedUserInfo=r,this.cachedTenantConfig=this.convertToTenantConfig(t),this.broadcastImpl(f,u))},i.prototype.convertToTenantConfig=function(n){var t=n.tenantDisplayName,i=n.iconLarge,r=n.iconLargeChecksum,u=n.theme,f=n.adminEmail,e=n.themeColors;return{displayName:t,theme:u,iconLarge:i,iconLargeChecksum:r,adminEmail:f,themeColors:e}},i.prototype.broadcastImpl=function(t,i){var r=this;t===void 0&&(t=!0);this.cachedTenantSettings&&sj_evt.fire("bfbTenantSettings",this.cachedTenantSettings,this.cachedUserInfo,i,t,n.getSucceededEventDetails(this.cachedTenantSettings,i,t));this.cachedTenantConfig&&sj_evt.fire("bfbtcfg",this.cachedTenantConfig);this.cachedUserInfo&&this.cachedUserInfo.displayName&&this.cachedUserInfo.userPrincipalName?sj_evt.fire("bfbTenantSettingsUserInfo"):this.isUserInfoRetried||(this.isUserInfoRetried=!0,sj_evt.bind("aad:signedin",function(){n.isTenantSettingsPrefetchStarted=!1;r.getTenantSettings()},!0))},i}();t.TenantSettingsClient=h})(t=n.Service||(n.Service={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){var i;(function(i){i.userConfigsAjaxBound=n.Service.Midgard.userConfigsAjaxBound;var r=function(){function r(t,r,u){var f=this,e;this.onAjaxLoad=function(){var t=n.context,r=t.tenantId,u=t.aadUserId,i=function(){(r!==(f.cachedUserConfigs&&f.cachedUserConfigs.tenant&&f.cachedUserConfigs.tenant.id)||u!==(f.cachedUserConfigs&&f.cachedUserConfigs.user&&f.cachedUserConfigs.user.id))&&(n.isUserConfigsPrefetchStarted=!1,f.loadUserConfigs());f.broadcastImpl()};(n.context===null||n.context===void 0?void 0:n.context.isErrorBoundaryEnabled)&&n.withErrorBoundary?n.withErrorBoundary("onAjaxLoad",i,"UserConfigsClient"):i()};this.config=t;this.userConfigsApiUrl="".concat(t.apiUriBase).concat(t.userConfigsApiUri);this.cachedRequest=r;this.cvid=typeof _G!="undefined"?_G.IG:undefined;e=function(){i.userConfigsAjaxBound||(sj_evt.bind("ajax.load",f.onAjaxLoad,!0,null,!0),i.userConfigsAjaxBound=!0)};(n.context===null||n.context===void 0?void 0:n.context.isErrorBoundaryEnabled)&&n.withErrorBoundary?n.withErrorBoundary("UserConfigsClientCtr",e,u):e()}return r.prototype.loadUserConfigs=function(t){var i=this,r={onSuccess:function(t,r){t&&i.broadcast(t,r)},onError:function(t,i,r){sj_evt.fire("bfbUserConfigsFailed",t,i,r,n.getFailedEventDetails(t,i))}};sj_evt.fire("bfbUserConfigsStarted",n.getStartedEventDetails());this.getUserConfigs(r,t);n.isUserConfigsPrefetchStarted=!0},r.prototype.getUserConfigs=function(n,i){var r={},u;this.cvid!==undefined&&(r.cvid=this.cvid);u=t.addArgsToUrl(this.config,i||this.userConfigsApiUrl,r);t.sendPostRequest(u,this.cachedRequest,n,this.config.userConfigsTimeout)},r.prototype.broadcast=function(t,i){var u=this,r;this.cachedUserConfigs=t;r=function(){return u.broadcastImpl(!1,i)};(n.context===null||n.context===void 0?void 0:n.context.isErrorBoundaryEnabled)&&n.withErrorBoundary?n.withErrorBoundary("broadcast",r,"UserConfigsClient"):r()},r.prototype.getCachedUserConfigs=function(){return this.cachedUserConfigs},r.prototype.broadcastImpl=function(t,i){var r=this;t===void 0&&(t=!0);this.cachedUserConfigs&&(sj_evt.fire("bfbUserConfigs",this.cachedUserConfigs,this.cachedRequest,i,t,n.getSucceededEventDetails(this.cachedUserConfigs,i,t)),this.cachedUserConfigs.userStatus&&n.whenWebTelemetryExists(function(){bfbTel.instUserStatus(r.cachedUserConfigs.userStatus)}))},r}();i.UserConfigsClient=r})(i=t.Midgard||(t.Midgard={}))})(t=n.Service||(n.Service={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){function f(i){var f,r,e;i&&i.length===5&&(f=i[1],t.vNextController==null&&(r=i[2],e=i[4],t.vNextController=new u(f,r,i[3]),r.useClientEngine&&!f.isUpsell?(r.useUserConfigSettings?sj_evt.bind("bfbUserConfigs",function(n){t.vNextController.startWhenReady(!0,!1,n[1])},!0,null,!1):sj_evt.bind("aad:signedin",function(){return t.vNextController.startWhenReady(!0)},!0,null,!1),sj_evt.bind("aad:signinfailed",function(){t.vNextController.startWhenReady(!1,!0)},!0,null,!1),e&&t.vNextController.startWhenReady()):t.vNextController.startWhenReady()))}function e(i){if(i&&i.length===5&&t.vNextController==null){var r=i[2],f=i[1],e=i[4];t.vNextController=new u(f,r,i[3]);e?sj_evt.bind("COMP_VS_READY",function(){return t.vNextController.startWhenReady(!0)},!0,null,!1):r.useClientEngine&&!f.isUpsell?sj_evt.bind("aad:signedin",function(){return t.vNextController.startWhenReady(!0)},!0,null,!1):t.vNextController.startWhenReady()}}var i=48,r=[t.NotificationKind.SignInFooterUpsell,t.NotificationKind.OverlaySignInUpsell,t.NotificationKind.AnaheimFooterUpsell,t.NotificationKind.SsoSucceeded,t.NotificationKind.SpotlightInfoBubble,t.NotificationKind.EduAssignSpotlightInfoBubble,t.NotificationKind.EduFilesSpotlightInfoBubble,t.NotificationKind.EduProfileSpotlightInfoBubble],u=function(){function u(i,r,u){this.loggedMainNotificationActions=[];this.isAjaxRequery=!1;this.bnpEventFired=!1;this.useReferencedLogo=!0;this.bfbTenantSettingsEventFired=!1;this.options=i;this.cfg=r;this.notification=u;this.userDataVNextClient=new n.Service.UserDataVNextClient(this.options.mtConfig,this.options.userData);this.cfg.useClientEngine&&(this.localUserDataClient=new n.Service.LocalUserDataClient,this.clientNotificationEngine=new t.ClientNotificationEngine(r,this.localUserDataClient,this.options));this.source=this.options.placement===0&&"UNHP"||this.options.placement===1&&"UNSP"||null;this.bindPageEventBeforeStart=this.bindPageEventBeforeStart.bind(this);this.startWhenReadyInternal=this.startWhenReadyInternal.bind(this);this.yieldAndStart=this.yieldAndStart.bind(this);this.checkForTenantSettings=this.checkForTenantSettings.bind(this);this.fetchTenantSettings=this.fetchTenantSettings.bind(this);this.applyTenantSettingsAndStart=this.applyTenantSettingsAndStart.bind(this);this.start=this.start.bind(this);this.isTargetReady=this.isTargetReady.bind(this);this.getTargetDimensions=this.getTargetDimensions.bind(this);this.showInternal=this.showInternal.bind(this);this.onShown=this.onShown.bind(this);this.hide=this.hide.bind(this);this.onDismiss=this.onDismiss.bind(this);this.instClick=this.instClick.bind(this);this.onWindowResize=this.onWindowResize.bind(this);this.logNotificationAction=this.logNotificationAction.bind(this);this.renderState=0}return u.prototype.startWhenReady=function(t,i,r){var f,u;if(this.renderState==0){if(this.renderState=1,i&&(this.source="SSOFAIL"),this.cfg.useClientEngine){f=sj_cook.get("BFBUSR","BAWAS");bfbTel.logValue(n.EventScope.BingAtWork,"AS",f);u=f==="1";this.cfg.refGlm&&t&&u&&this.options.placement===1&&this.isAjaxRequery&&n.poll({condition:function(){var n=_ge("bw-glm");return n&&(!!n.getElementsByClassName("chevronDown")[0]||!!n.getElementsByClassName("bw-glmList")[0])},callback:function(){},maxAttempts:5,baseIntervalInMillis:50,logName:"UserNotificationController.bfbSsoRef",timeOutCallback:function(){var t="bfbSsoR";_w.location.href.indexOf(t)<0&&(bfbTel.logValue(n.EventScope.UserNotification,"GLMRF","1"),_w.location.href="".concat(_w.location.href,"&").concat(t))}});var e=this.clientNotificationEngine.decide(t,u,this.options.hasMsa,this.options.isUpsell||i,r),o=e.shown,s=e.suppressed;this.notification=o;this.options.supNotifyKinds=s.map(function(n){return n.notifyKind})}this.bindPageEventBeforeStart();this.startWhenReadyInternal()}},u.prototype.bindPageEventBeforeStart=function(n){var t=this;sj_evt.bind("bfbNotificationShown",function(n){return t.onShown(n&&n[1],n&&n[2],!0,n&&n[3])},!0,null,!0);sj_evt.bind("bfbNotificationDismiss",function(n){return t.onDismiss(n&&n[1],n&&n[2])},!0,null,!0);n||sj_evt.bind("ajax.load",function(){t.bindPageEventBeforeStart(!0);t.clearLoggedAction()},!0,null,!0)},u.prototype.startWhenReadyInternal=function(){var i=this,r;if(this.logSuppressions(),r=this.notification&&this.notification.notifyKind,r==null||r===t.NotificationKind.None){this.renderState=7;return}this.bindToPageEvents();sj_evt.bind("onBnpRender",function(){i.bnpEventFired=!0;i.yieldAndStart()},!0,null,!0);this.options.placement===1?sj_evt.bind("onPP",this.yieldAndStart,!0,null,!0):this.options.placement===2&&sj_evt.bind("identityHeaderShown",this.yieldAndStart,!0,null,!0);sj_evt.bind("ajax.load",function(){i.isAjaxRequery=!0;i.hide(!1,!0)},!0,null,!0);this.cfg.timeoutInMs>=0&&(this.readyTimer=sb_st(function(){i.renderState===2&&(i.renderState=5,bfbTel.logValue(n.EventScope.UserNotification,"Timed out","",{RM:i.notification&&i.notification.renderMode}))},this.cfg.timeoutInMs));sb_st(function(){i.bnpEventFired||bfbTel.logValue(n.EventScope.UserNotification,"onBnpRender awaited","",{PMT:i.options.placement})},3e3)},u.prototype.bindToPageEvents=function(){var i=this,r,t;switch(this.options.placement){case 0:sj_be(_w,"resize",this.onWindowResize);r=_ge("hp_scroll")||_ge("scroll_cont");r&&sj_be(r,"scroll",this.onWindowResize);break;case 1:sj_be(_w,"resize",this.onWindowResize);sj_be(_w,"scroll",this.onSerpScroll)}t=function(){(i.loggedMainNotificationActions==null||i.loggedMainNotificationActions.length===0)&&i.logNotificationAction(3)};sj_be(_w,"beforeunload",t);sj_evt.bind("unload",t);sj_evt.bind("threshold.pageUnload",t)},u.prototype.logSuppressions=function(){this.options.supNotifyKinds&&this.options.supNotifyKinds.length>0&&this.userDataVNextClient.notificationActionBatch(this.options.supNotifyKinds.map(function(n){return{notification:n,action:3,domain:undefined}}))},u.prototype.onWindowResize=function(){(this.renderState===3||this.renderState===4)&&this.notification.renderMode===0&&this.tryToShow(!0)},u.prototype.onSerpScroll=function(){var n=_d.documentElement.scrollHeight-_w.innerHeight-i,t=_w.pageYOffset,r=_ge("bw-un-vnext-footer"),u=_ge("bw-un-vnext-anaFooter"),f=_ge("bw-un-vnext-anaFooterNol");r!=null?r.style.bottom=t>=n?"".concat(i,"px"):"0px":u!=null?u.style.bottom=t>=n?"".concat(i,"px"):"0px":f!=null&&(f.style.bottom=t>=n?"".concat(i,"px"):"0px")},u.prototype.yieldAndStart=function(){if(this.cfg.forced||!this.cfg.yield||this.notification.renderAgg)this.checkForTenantSettings();else if(this.options.placement==1&&this.notification.notifyKind!==t.NotificationKind.SsoSucceeded){if(this.options.hasBnpNotificationOnSerp){this.logNotificationAction(3);bfbTel.logValue(n.EventScope.UserNotification,"Yielded",this.notification&&this.notification.notifyKind,{RM:this.notification&&this.notification.renderMode});return}this.checkForTenantSettings()}else{if(["thp_notf_div","bnp_atop","bnp_ttc","b_notificationContainer"].some(function(n){return _ge(n)!=null})||_d.getElementsByClassName("bubblePlaceholder").length>0||_ge("caro_sunset")!=null){this.logNotificationAction(3);bfbTel.logValue(n.EventScope.UserNotification,"Yielded","",{RM:this.notification&&this.notification.renderMode});return}this.checkForTenantSettings()}},u.prototype.checkForTenantSettings=function(){var i=this,u=[t.NotificationKind.OverlaySignInUpsell,t.NotificationKind.SpotlightInfoBubble,t.NotificationKind.EduProfileSpotlightInfoBubble],f=this.cfg.forced&&u.indexOf(this.cfg.forcedNotifKind)>-1,r;if(!this.options.loadTntCfg&&this.notification.notifyKind!=t.NotificationKind.SsoSucceeded&&(u.indexOf(this.notification.notifyKind)<0||f)||this.options.placement==0){this.useReferencedLogo=!0;this.notification.queries=this.options.expQries;this.notification.showUserInfo?this.fetchUserInfo():this.start();return}r=function(n){sj_evt.unbind("bfbTenantSettings",r);i.applyTenantSettingsAndStart({tenantSettings:n&&n[1],user:n&&n.length>1&&n[2]},!0)};this.options.placement===1||this.options.placement===2?(sj_evt.bind("bfbTenantSettings",r,!0,null,!0),sb_st(function(){i.bfbTenantSettingsEventFired||(bfbTel.logValue(n.EventScope.UserNotification,"PageEvent.TenantSettings awaited","",{PMT:i.options.placement}),sj_evt.unbind("bfbTenantSettings",r),i.fetchTenantSettings())},200)):this.fetchTenantSettings()},u.prototype.fetchUserInfo=function(){var t=this,i=new n.Service.UserInfoClient(this.options.mtConfig),r={onSuccess:function(i){t.applyUserInfoAndStart(i)},onError:function(i){t.start()}};i.getUserInfo(r)},u.prototype.fetchTenantSettings=function(){var t=this,i=new n.Service.TenantSettingsClient(this.options.mtConfig,undefined,"caller: fetchTenantSettings, file: UserNotificationVNextController"),r={onSuccess:function(i){t.applyTenantSettingsAndStart(i)},onError:function(i){t.start()}};sb_st(function(){return i.getTenantSettings(r)},1)},u.prototype.applyTenantSettingsAndStart=function(t,i){var r=t.tenantSettings,u=t.user;r&&(i&&(this.bfbTenantSettingsEventFired=!0),this.options.theme=r.theme||this.options.theme,this.options.tenantName=r.tenantDisplayName||this.options.tenantName,this.options.themeColors=r.themeColors||this.options.themeColors,r.iconLarge&&(this.options.tenantLogoSrc=r.iconLarge,this.useReferencedLogo=!1,this.options.iconLargeChecksum=r.iconLargeChecksum),r.exploreQueries&&r.exploreQueries.length>0&&(this.notification.queries=r.exploreQueries),(u===null||u===void 0?void 0:u.displayName)&&(this.options.userDisplayName=u===null||u===void 0?void 0:u.displayName));this.notification.showUserInfo?this.fetchUserInfo():this.start()},u.prototype.applyUserInfoAndStart=function(t){t&&(this.options.userEmailId=t.userPrincipalName||this.options.userEmailId,this.options.userDisplayName=t.displayName,this.options.userProfilePhotoUrl=this.options.mtConfig.apiUriBase+this.options.mtConfig.profilePhotoApiUri.replace("{0}",t.id),this.options.emailIdNameTruncationCount=this.options.mtConfig.emailIdNameTruncationCount,this.options.emailIdCompanyNameTruncationCount=this.options.mtConfig.emailIdCompanyNameTruncationCount,this.options.tenantNameTruncationCount=this.options.mtConfig.tenantNameTruncationCount);this.start()},u.prototype.start=function(){if(this.notification==null){this.renderState=7;return}if(clearTimeout(this.readyTimer),this.renderState===1){if(this.notification.useExpQries&&(!this.notification.queries||this.notification.queries.length==0)&&this.notification.notifyKind!==t.NotificationKind.SsoSucceeded){bfbTel.logDiag("No explore queries - dropped notification",{PMT:this.options.placement,UNT:this.notification.notifyKind,RM:this.notification.renderMode});return}if(this.renderState=2,this.element==null){if(this.notification.renderMode===1)return;if(this.notification.notifyKind==t.NotificationKind.OverlaySignInUpsell)this.element=t.createPopupForSignInUpsell(this.notification,this.options.tenantName,this.options.tenantLogoSrc,this.options.iconLargeChecksum,this.options.theme,this.options.themeColors,this.options.hasMsa,this.options.upsellSwoopImageUrl,this.options.upsellSharepointImageUrl,this.options.upsellAvatarImageUrl,this.options.upsellWordImageUrl,this.options.upsellPowerPointImageUrl,this.options.upsellAvatar1ImageUrl,this.options.upsellExcelImageUrl);else if(this.options.mtConfig.isMobile)this.element=t.createPopupForMob(this.notification,this.options.placement,this.options.theme,this.options.privacyLink,n.strFormat(this.options.signOutLinkFmt,_w.location.href),this.options.tenantLogoSrc,this.useReferencedLogo,this.options.workQueryUrlFmt,this.options.tenantName,this.options.userEmailId,this.options.userProfilePhotoUrl,this.options.emailIdNameTruncationCount,this.options.emailIdCompanyNameTruncationCount,this.options.tenantNameTruncationCount);else if(this.notification.notifyKind==t.NotificationKind.SignInFooterUpsell)this.element=t.createSignInFooterUpsell(this.notification,this.options.tenantName,this.options.hasMsa,this.options.upsellImageUrl);else if(this.notification.notifyKind==t.NotificationKind.AnaheimFooterUpsell)this.element=t.createAnaheimFooterUpsell(this.notification,this.options.upsellAnaheimImageUrl,this.options.mtConfig.flights.indexOf("bfbanaupnol")<0,this.options.mtConfig.flights.indexOf("bfbanaupr")>=0,this.options.tenantName);else if(this.notification.notifyKind==t.NotificationKind.RewardsFRENotification)this.element=t.createRewardsFRENotification&&t.createRewardsFRENotification(this.notification,this.options.rewardsBannerUrl,this.options.microsoftImageUrl);else{var i=this.options.tenantLogoSrc;(this.notification.notifyKind==t.NotificationKind.SpotlightInfoBubble||this.notification.notifyKind==t.NotificationKind.EduProfileSpotlightInfoBubble)&&(i=null,this.notification.title=this.options.userDisplayName?n.strFormat(this.notification.title,n.getFirstNameOrFullName(this.options.userDisplayName)):n.Strings.SpotlightInfoBubble_TitleWithoutName);(this.notification.notifyKind==t.NotificationKind.EduAssignSpotlightInfoBubble||this.notification.notifyKind==t.NotificationKind.EduFilesSpotlightInfoBubble)&&(i=null);this.element=t.createPopup(this.notification,this.options.placement,this.options.theme,this.options.themeColors,this.options.privacyLink,n.strFormat(this.options.signOutLinkFmt,_w.location.href),i,this.useReferencedLogo,this.options.workQueryUrlFmt,this.options.tenantName,this.options.iconLargeChecksum)}if(this.element==null){this.cancel();return}_d.body.appendChild(this.element);this.attachEventHandlers()}this.tryToShow()}},u.prototype.tryToShow=function(t){var i=this;if(this.cfg.minWinWidth&&_w.innerWidth<this.cfg.minWinWidth&&!this.notification.renderAgg&&r.indexOf(this.notification.notifyKind)==-1){this.hide();return}t?this.showInternal():sb_st(function(){return n.poll({condition:i.isTargetReady,maxAttempts:i.cfg.timeoutInMs>0?20:200,baseIntervalInMillis:50,logName:"UserNotificationController.tryToShow",callback:i.showInternal})},this.cfg.showDelayInMs)},u.prototype.hide=function(t,i){if(this.element)if(i,this.element.style.display="none",t)this.onDismiss(this.notification.notifyKind);else this.renderState=4},u.prototype.onDismiss=function(n,t){this.renderState=6;var i=t||{},r=i.notificationDomain,u=i.notificationCampaign;bfbTel.logDiag("Received NotificationEvent",{eventId:"NotificationEventReceived",notificationAction:2,notificationKind:n,notificationDomain:r,notificationCampaign:u});this.logNotificationAction(2,n,t)},u.prototype.cancel=function(){this.renderState=5;this.logNotificationAction(3)},u.prototype.isTargetReady=function(){return(this.getTargetDimensions()!=null||this.notification.notifyKind==t.NotificationKind.SignInFooterUpsell||this.notification.notifyKind==t.NotificationKind.AnaheimFooterUpsell)&&this.renderState!==5},u.prototype.getTargetDimensions=function(){var i=_ge(this.notification.targetElementId),t;return i==null?null:(t=i.getBoundingClientRect(),t==null||t.top===0&&t.right===0&&t.bottom===0&&t.left===0)?null:t},u.prototype.showInternal=function(){var o,i,s,l;if(this.notification.notifyKind!=t.NotificationKind.SignInFooterUpsell&&this.notification.notifyKind!=t.NotificationKind.AnaheimFooterUpsell){if(o=_w.innerWidth,i=this.getTargetDimensions(),i==null)return;var u,h=void 0,c=void 0,f=void 0,e=void 0,r=this.notification;switch(this.notification.alignment){case 1:u=i.bottom;f=i.left;break;case 2:u=i.bottom;h=o-i.right;break;case 3:u=i.top;f=i.right;break;case 4:u=i.bottom;e=r?i.right+r.popupWidth+r.popupPadding+r.popupOffset:0;e>o?f=i.right-(e-o):(e=0,f=i.right);break;case 5:c=0;break;default:return}this.notification.alignment===4&&(s=_ge("b_op_flyout"),s&&s.className.indexOf("b_op_actv")>0&&(s.className=s.className.replace("b_op_actv","")));this.element.style.top=u==null?null:"".concat(u,"px");this.element.style.right=h==null?null:"".concat(h,"px");this.element.style.bottom=c==null?null:"".concat(c,"px");this.element.style.left=f==null?null:"".concat(f,"px");this.element.style.display="block";this.element.classList.remove("b_hide");this.element.getElementsByClassName("bw-unArwTop bw-unArwAcctRt").length>0&&r&&(l=this.element.getElementsByClassName("bw-unArwTop bw-unArwAcctRt")[0],l.style.right=e!=0?"".concat(r.popupArrowOffset-(e-o),"px"):"".concat(r.popupArrowOffset,"px"))}this.onShown(this.notification.notifyKind)},u.prototype.onShown=function(i,u,f,e){f===void 0&&(f=!1);this.renderState=3;var h=e||{},o=h.notificationDomain,s=h.notificationCampaign;bfbTel.logDiag("Received NotificationEvent",{eventId:"NotificationEventReceived",notificationAction:0,notificationKind:i,notificationDomain:o,notificationCampaign:s});this.alreadyLoggedAction(i,0,o,s)?bfbTel.logDiag("Duplicate Notification event",{eventId:"NotificationEventIgnored",notificationAction:0,notificationKind:i,notificationDomain:o,notificationCampaign:s}):(this.logNotificationAction(0,i,e),i&&r.indexOf(i)>-1&&bfbTel.logShown(n.EventScope.UserNotification,this.notification.notifyKind,u||this.source,{RM:this.notification.renderMode,eventId:"Notification_Impression",notificationKind:t.NotificationKind[this.notification.notifyKind]}),f||sj_evt.fire("bfbNotificationShown",null,this.notification.notifyKind))},u.prototype.attachEventHandlers=function(){var n=this,r=this.element.getElementsByClassName("bw-unDis")[0],i,t;sj_be(r,"click",function(){return n.hide(!0)});sj_be(r,"mousedown",function(){return n.instClick("DIS")});i=this.element.getElementsByClassName("bw-unActs")[0];i&&this.notification.actionBtns.forEach(function(t){var u=i.getElementsByClassName("bw-unActBtn".concat(t.target))[0],r;sj_be(u,"mousedown",function(){return n.instClick(t.target)});r=null;switch(t.target){case"GOTIT":r=function(){return n.hide(!0)};break;case"SIGNOUT":r=function(){return _ge("bw-unSnOtFrm").submit()};break;case"SIGNIN":case"SWITCHACCOUNTS":r=function(){return sj_cook.set("SRCHUSR","POEX","O",!0,"/")}}r&&sj_be(u,"click",r)});t=this.element.getElementsByClassName("bw-expQryLnk");t&&t.length>0&&Array.prototype.forEach.call(t,function(t,i){sj_be(t,"mousedown",function(){return n.instClick("QRY",{I:i++})})})},u.prototype.logNotificationAction=function(n,t,i){var f=t?t:this.notification.notifyKind,e=i||{},r=e.notificationDomain,u=e.notificationCampaign;if(n!==2){if(this.alreadyLoggedAction(t,n,r,u)){bfbTel.logDiag("Duplicate Notification event",{eventId:"NotificationEventIgnored",notificationAction:n,notificationKind:t,notificationDomain:r,notificationCampaign:u});return}this.loggedMainNotificationActions.push({userNotificationKind:t,userNotificationActionKind:n,userNotificationDomain:r,userNotificationCampaign:u})}this.cfg.useClientEngine?this.localUserDataClient.logNotificationAction(f,n):this.userDataVNextClient.notificationAction({notification:f,action:n,domain:r,campaign:u})},u.prototype.alreadyLoggedAction=function(n,t,i,r){if(n==null&&(n=this.notification&&this.notification.notifyKind),this.loggedMainNotificationActions)for(var u in this.loggedMainNotificationActions)if(this.loggedMainNotificationActions[u].userNotificationKind==n&&this.loggedMainNotificationActions[u].userNotificationActionKind==t&&this.loggedMainNotificationActions[u].userNotificationDomain==i&&this.loggedMainNotificationActions[u].userNotificationCampaign==r)return!0;return!1},u.prototype.clearLoggedAction=function(){this.loggedMainNotificationActions.splice(0,this.loggedMainNotificationActions.length)},u.prototype.instClick=function(i,u){if(u==null&&(u={}),u.UNT=this.notification.notifyKind,u.RM=this.notification.renderMode,i==="SIGNOUT")u.eventId="Notification_Signout_Click",bfbTel.logSignout(n.EventScope.UserNotification,i,this.source,u);else{var f=this.notification&&this.notification.notifyKind;f&&r.indexOf(f)>-1&&(u.eventId=i==="DIS"?"Notification_Dismiss_Click":"Notification_Engagement_Click",u.notificationKind=t.NotificationKind[f]);bfbTel.logClicked(n.EventScope.UserNotification,!1,i,this.source,u)}},u}();t.UserNotificationVNextController=u;t.userNotificationVNextEntry=f;t.userNotificationVNextEntryEhp=e;sj_evt.bind("bfbUserNotificationExists",f,!0,null,!0);sj_evt.bind("bfbUserNotificationExistsEhp",e,!0,null,!0)})(t=n.UserNotification||(n.UserNotification={}))}(BingAtWork||(BingAtWork={}));0