var __spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},__assign,BingAtWork;(function(n){function u(t){n.writeSessionStorage("BingAtWorkConversationId",t)}var i=[],r,t;n.isWindow=function(){return typeof window!="undefined"&&!!window};r=function(){function r(){this.signoutEvtHandlerAdded=!1;this.signoutRetentionNotification="SignoutRetention";this.dwell={};this.queryRegex=new RegExp(/[^/](query|((\?|&)(q|pq)))(?:\"?)(?: ?)([:=])/i);this.nameRegex=new RegExp(/name(?:\"?)(?: ?)([:=])/i);this.userRegex=new RegExp(/user(?:\"?)(?: ?)([:=])/i);this.UPNRegex=new RegExp(/((userprincipalname)|(upn))(?:\"?)(?: ?)([:=])/i);this.emailRegex=new RegExp(/(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))/);this.QueryRule={key:"Query",regex:this.queryRegex};this.NameRule={key:"Name",regex:this.nameRegex};this.UserRule={key:"User",regex:this.userRegex};this.UPNRule={key:"UPN",regex:this.UPNRegex};this.EmailRule={key:"Email",regex:this.emailRegex};this.RuleSet=[this.EmailRule,this.QueryRule,this.NameRule,this.UserRule,this.UPNRule,];this.checkRules=function(n){var t=!0;return this.RuleSet.forEach(function(i){i.regex.test(n)&&(t=!1)}),t};this.dwellOnUnload=this.dwellOnUnload.bind(this)}return r.init=function(n){typeof bfbTel!="undefined"&&bfbTel.initialized||n!=null&&!n.isMtr&&n.cfg!=null&&n.cfg.e&&n.cfg.env!=="TEST"&&(bfbTel.setContext(n),bfbTel.regLogPagePerf(),bfbTel.regTenantSettingsUpdate(),sj_evt.fire("bfbWebTelemetryInitReady"))},r.prototype.setContext=function(r){var u=this,s,e,f,a,h;for(this.ctx=r,this.initialized||(this.initialized=!0,this.ariaLogger=AriaTelemetry.getLogger(r.cfg.t),sj_evt.bind("beforeunload",function(){var t=n.context;(t.wsb||n.isWindow()&&!window.MSLog)&&u.ariaLogger.flushAndTeardown()}),e=(s=n.context===null||n.context===void 0?void 0:n.context.mtCfg)===null||s===void 0?void 0:s.flights,e&&(e.indexOf("bfblqost")>-1&&this.logDiag("immediate trigger",{eventId:"qosTest"}),e.indexOf("bfblqost2s")>-1&&setTimeout(function(){return u.logDiag("2 second delay trigger",{eventId:"qosTest"})},2e3)));i.length>0;){var o=i.shift()||{},c=o.s,l=o.n,v=o.kv,y=o.noContextualKV;c&&l&&this.log(c,l,v,y)}f=this.ctx.isHomepage;sj_evt.bind("bfbWebTelemetryInitReady",function(){var i={};i.alreadySignedIn=n.context&&!!n.context.isAadAuthenticatedAtServer;i.ssoSignedIn=n.context&&!!n.context.isAadAuthenticatedBySSO;u.log(f?t.BingAtWorkHomepage:t.BingAtWork,"SignedIn_Events",i)},!0,undefined,!0);sj_evt.bind("aad:signedin",function(i){var e,r={},o=(e=i[1])===null||e===void 0?void 0:e.userObjectId;n.context&&(r.alreadySignedIn=!!n.context.isAadAuthenticatedAtServer,n.context.isAadAuthenticatedBySSO=u.lastSSOAttempt!==null,r.ssoSignedIn=n.context.isAadAuthenticatedBySSO);o&&(u.ctx.uid=o,n.context&&(n.context.aadUserId=o));r.latency=u.lastSSOAttempt!==undefined?(performance.now()-u.lastSSOAttempt).toFixed(2):"-1";u.lastSSOAttempt=undefined;u.log(f?t.BingAtWorkHomepage:t.BingAtWork,"SignedIn_Events",r)},!0,undefined,!0);sj_evt.bind("aad:signedout",function(){var i={};n.context&&(n.context.isAadAuthenticatedBySSO=!1);i.latency=u.lastSSOAttempt!==undefined?(performance.now()-u.lastSSOAttempt).toFixed(2):"-1";u.lastSSOAttempt=undefined;u.log(f?t.BingAtWorkHomepage:t.BingAtWork,"SsoError_Events",i)},!0,undefined,!0);sj_evt.bind("aad:ssoattempt",function(){u.lastSSOAttempt=performance.now()},!0,undefined,!0);sj_evt.bind("ajax.unload",function(){u.dwellOnUnload("A")});_w.addEventListener("beforeunload",function(){u.dwellOnUnload("W")});a=function(){u.logSignout(f?t.BingAtWorkHomepage:t.BingAtWork)};h=function(){n.poll({condition:function(){var t=_ge("postLink");return!u.signoutEvtHandlerAdded&&t&&(sj_be(t,"click",a),u.signoutEvtHandlerAdded=!0),u.signoutEvtHandlerAdded},maxAttempts:50,baseIntervalInMillis:100,logName:"SignoutButton:polling"})};sj_be(_ge("id_n"),"click",h);sj_be(_ge("id_p"),"click",h);sj_evt.bind("Identity.SignoutNotifShown",function(){u.logShown(n.EventScope.UserNotification,0,undefined,{eventId:"Notification_Impression",notificationKind:u.signoutRetentionNotification})});sj_evt.bind("Identity.SignoutNotifSignoutClick",function(){u.logClicked(n.EventScope.UserNotification,!1,undefined,undefined,{eventId:"Notification_Dismiss_Click",notificationKind:u.signoutRetentionNotification})});sj_evt.bind("Identity.SignoutNotifBackgroundClick",function(){u.logClicked(n.EventScope.UserNotification,!1,undefined,undefined,{eventId:"Notification_Hide_BackgroundClick",notificationKind:u.signoutRetentionNotification})});sj_evt.bind("Identity.SignoutNotifCancelClick",function(){u.logClicked(n.EventScope.UserNotification,!1,undefined,undefined,{eventId:"Notification_Engagement_Click",notificationKind:u.signoutRetentionNotification})})},r.prototype.logShown=function(n,t,i,r){t!=null&&(r=r||{},r.T=String(t));i!=null&&(r=r||{},r.S=i);this.log(n,"Shown_Events",r);this.fireImpressionForMipnTelemetry(n,r)},r.prototype.fireImpressionForMipnTelemetry=function(n,i){if(n===t.UserNotification&&i&&i.notificationKind&&sj_evt.fire("MIPN.Telemetry.".concat(i.notificationKind,"Notification.Impression")),i&&i.eventId&&typeof i.eventId=="string"){var f=i.eventId,u=r.conversionLinkImpressionEventMap[f];u&&sj_evt.fire("MIPN.Telemetry.".concat(u,"ConversionLink.Impression"))}},r.prototype.logRanking=function(n,i,r,u){var f=n||{placement:null,treatment:null,rankingRuleId:null,legend:null},e=f.placement,o=f.treatment,s=f.rankingRuleId,h=f.legend,c={P:e,T:o,R:s,L:h,MTHD:i,AUD:r==null?null:r?1:0,ERR:u?"UNEXPCTRL":null};this.log(t.BingAtWork,"Ranking_Events",c)},r.prototype.logQuery=function(n,i){var r;if(n){var u=n.encryptedQuery,f=n.queryCount,e=n.queryFrequency,o=n.bhvr,s=n.webIntentConf,h=n.ssp,c=n.intent,l=n.groupId;r={QRY:u,CNT:f,FRQ:e,BHVR:o,CONF:s,SSP:h,INT:c,GID:l}}else r={NWK:1,QID:i};console.log("*** TEST");this.log(t.BingAtWork,"Query_Events",r)},r.prototype.logClicked=function(n,i,u,f,e){u!=null&&(e=e||{},e.T=u);f!=null&&(e=e||{},e.S=f);this.log(n,"Clicked_Events",e);this.fireClickForMipnTelemetry(n,e);this.ctx&&this.ctx.sci&&(i?this.sendExternalClickRateInst():this.inst(r.instClickEventType,"BfbClick",{BFB_EXT:i?"1":"0",BFB_T:u,BFB_S:f,BFB_SC:t[n]}));var o={scope:n,target:u,source:f,properties:e};sj_evt.fire("BingAtWork:Click",o)},r.prototype.fireClickForMipnTelemetry=function(n,i){var u,f,e;i&&i.eventId&&typeof i.eventId=="string"&&(u=i.eventId,n===t.UserNotification&&i&&i.notificationKind&&(f=r.notificationClickToTelemetryEventMap[u],f&&sj_evt.fire("MIPN.Telemetry.".concat(i.notificationKind,"Notification.").concat(f))),e=r.conversionLinkClickEventMap[u],e&&sj_evt.fire("MIPN.Telemetry.".concat(e,"ConversionLink.EngagementClick")))},r.prototype.logValue=function(n,t,i,r){r=r||{};r.N=t;r.V=i;this.log(n,"Value_Events",r)},r.prototype.logSignout=function(n,t,i,r){this.logClicked(n,!1,t,i,r);this.log(n,"SignedOut_Events",r)},r.prototype.logRtt=function(n,t,i,r){var u=this.getRequestRtt(i,r);if(u&&!(u.getCall<0)&&!(u.startCall<0)){var f=u==null?"NOPERF":u.getCall.toFixed(2),e=u==null?"NOPERF":u.startCall.toFixed(2),o={N:t,V:f,ST:e};this.log(n,"Rtt_Events",o)}},r.prototype.logSerpLinkClick=function(n,i){var r={T:"SERP",DOM:n,SERPID:i};this.log(t.Serp,"Clicked_Events",r)},r.prototype.logDiag=function(n,i){i=i||{};i.MSG=n;this.log(t.Diag,"Diag_Events",i)},r.prototype.logErr=function(n,t,i,r,u,f,e){if(f=f||{},f.eventId=r==="UncaughtError"?r:t,f.message=t,this.checkIfPIIClean(i)&&(f.fullMsg=i),u){var o=this.sanitizeUrls(u);this.checkIfPIIClean(o)&&(f.stackTrace2=o)}this.log(n,"Errors",f,e)},r.prototype.regLogPagePerf=function(){var i=this,t;performance!=null&&performance.getEntries!=null&&(t=function(){i.logPagePerf();sj_evt.unbind("onP1",t)},sj_evt.bind("onP1",t,!0,0,!1))},r.prototype.logPagePerf=function(){for(var n,f,e,i=0,u=performance.getEntries();i<u.length;i++){n=u[i];for(f in r.pagePerfMatchConfig)r.pagePerfMatchConfig[f](n)&&(e={N:f,P:n.name,ET:n.entryType,IT:n.initiatorType,FETCH_S:n.fetchStart,REQ_S:n.requestStart,RES_S:n.responseStart,RES_E:n.responseEnd,D:n.duration,TSZ:n.transferSize},this.log(t.BingAtWork,"Perf_Events",e))}},r.prototype.log=function(n,t,r,u){r===void 0&&(r={});this.ariaLogger!=null?this.logInternal(n,t,r,u):i.push({s:n,n:t,kv:r,noContextualKV:u})},r.prototype.logInternal=function(i,r,u,f){var e,o,s,h,c;if(u===void 0&&(u={}),e={eventType:"Client_Events",name:r||"",properties:{}},f||this.fillContextualKV(i,u),u!=null)for(o=0,s=Object.getOwnPropertyNames(u);o<s.length;o++)h=s[o],c=u[h],e.properties[h]={value:c!=null?c:""};this.ariaLogger.logEvent(e)},r.prototype.fillContextualKV=function(t,i){var r=this.ctx,e=r.cfg,o=r.uid,s=r.ig,h=r.tid,c=r.sid,l=r.muid,a=r.tn,v=r.tnid,y=r.msa,p=r.mkt,w=r.b,b=r.dev,k=r.os,d=r.osver,g=r.dc,nt=r.snrVersion,tt=r.canvas,f=typeof _G=="undefined"?{IG:s,EventID:h}:_G,u=n.context,it=u&&u.isEudbEnforced,rt=u&&u.formCode||"";i.ENV=e.env;i.environment=e.env;i.SC=t;i.IG=f.IG;i.impressionGuid=f.IG;i.SID=c;i.TID=f.EventID;it||(i.UID=o);i.MUID=l;i.F=rt;i.TN=a;i.TNID=v;i.MSA=y;i.MKT=p;i.B=w;i.deviceType=b;i["DeviceInfo.OsName"]=k;i["DeviceInfo.OsVersion"]=d;i.dataCenter=g;i.clientType=this.getClientType(u);i.snrVersion=nt;i.logicalSearchId=u&&u.logicalId;i.conversationId=u&&u.conversationId;i.canvas=tt;i.isSnr=!0},r.prototype.getClientType=function(n){return(n===null||n===void 0?void 0:n.isOnWorkVertical)&&(n===null||n===void 0?void 0:n.wsb)?"WsbBingVertical":(n===null||n===void 0?void 0:n.isOnWorkVertical)?"BingVertical":(n===null||n===void 0?void 0:n.wsb)?"Wsb":"Bing"},r.prototype.getRequestRtt=function(t,i){var e=this,f,u,r;return performance==null||performance.getEntries==null?null:(f=performance.getEntries(),u=f.filter(function(r){if(r.name==null)return!1;var u=function(t){var i=r.name.toLowerCase(),u=e.getPathName(i)==="/search";return!u&&n.hasSub(i,t)};return t.every(u)&&(i==null||!i.some(u))}),u.length<1)?{getCall:-1,startCall:-1}:(r=u[0],{getCall:r.duration,startCall:r.fetchStart||r.startTime})},r.prototype.getPathName=function(n){var t=document.createElement("a");return t.href=n,t.pathname},r.prototype.sendExternalClickRateInst=function(){if(typeof _w.si_ct=="function"){var n=_ge("bfb_ExternalLink")||_ge("bfb_InstrumentationLink");n&&_w.si_ct(n)}},r.prototype.instCommand=function(n){this.inst(r.instEventType,"BfbCommand",n)},r.prototype.instAnswerExpansion=function(n){this.inst(r.instEventType,"BfbAnswerExpanded",{V:"1",P:n})},r.prototype.instGleam=function(n){this.inst(r.instEventType,"BfbGleam",{N:n})},r.prototype.instPLT=function(n){this.inst(r.instEventType,"BawPLT",{V:n})},r.prototype.instUserStatus=function(t){var i={};(t===null||t===void 0?void 0:t.ageInDays)&&(i.AgeInDays=t.ageInDays.toString());n.context.isContributedToBingEnabled&&typeof(t===null||t===void 0?void 0:t.isContributedToBingByMsb)=="boolean"&&(i.IsContributedToBingByMsb=t.isContributedToBingByMsb.toString());i&&this.inst(r.instEventType,"UserStatus",i)},r.prototype.instSubsequentLogicalId=function(n){this.inst(r.instEventType,"SubsequentLogicalId",{logicalId:n})},r.prototype.inst=function(t,i,u){for(var o,f=[],e=0,s=Object.getOwnPropertyNames(u);e<s.length;e++)o=s[e],f.push(o),f.push(u[o]||"");Log.Log.apply(Log,__spreadArray([t,i,r.instEventName,!1],f,!1))},r.prototype.dwellStart=function(i,r){var u=this,f;f={DW_S:Date.now(),S:r};n.poll({condition:function(){return u.ctx!=null},maxAttempts:50,baseIntervalInMillis:50,logName:"WebTelemetry.dwellStart:polling",callback:function(){u.fillContextualKV(i,f);u.dwell[i]=f}})},r.prototype.dwellEnd=function(i){this.logDwell(i);try{delete this.dwell[i]}catch(r){this.dwell[i]=null}},r.prototype.logDwell=function(n,t){var i=this.dwell[n];if(i&&i.DW_S){var u=i.DW_S,r=Date.now(),f=r-u;i.N="DWELL";i.V=f;i.DW_E=r;i.DW_UL=t;this.log(n,"Value_Events",i,!0)}},r.prototype.dwellOnUnload=function(n){for(var i,t=0,r=Object.getOwnPropertyNames(this.dwell);t<r.length;t++)i=r[t],this.dwell.hasOwnProperty(i)&&this.dwell[i]&&this.logDwell(i,n);this.ariaLogger.flush()},r.prototype.regTenantSettingsUpdate=function(){var t=this;sj_evt.bind("bfbTenantSettings",function(i){var r=i[1];t.ctx.tn=r.tenantDisplayName;t.ctx.tnid=t.ctx.tnid||r.tenantObjectId;n.context&&!n.context.tenantId&&(n.context.tenantId=r.tenantObjectId)},!0,undefined,!0)},r.prototype.sanitizeUrls=function(n){var r=new RegExp(/(?:https?|ftp):\/\/[^ ()]+/g),u=new RegExp(/\/[A-Za-z0-9\_]+.js:[0-9]+:[0-9]+/g),t=n===null||n===void 0?void 0:n.match(r),i=n;return t===null||t===void 0?void 0:t.forEach(function(n){var t,r=(t=n===null||n===void 0?void 0:n.match(u))===null||t===void 0?void 0:t.shift(),f="[URL Removed]".concat(r||"");i=i.replace(n,f)}),i},r.prototype.checkIfPIIClean=function(n){var t=!1;try{t=this.checkRules(n)}catch(i){}return t},r.instEventType="ClientInst",r.instClickEventType="DHTMLClick",r.instEventName="BAW",r.conversionLinkImpressionEventMap={Mainline_SNR_Low_Confidence_See_Results_Impression:"MainlineSNRLowConfidenceSeeResults",Tenant_To_Homepage_Impression:"TenantToHomepage",Tenant_To_ZQ_Impression:"TenantToZQ",Tenant_To_BackArrow_Impression:"TenantToBackArrow",Tenant_To_Chat_Impression:"TenantToChat",Header_To_ZQ_Impression:"HeaderToZQ"},r.conversionLinkClickEventMap={Mainline_SNR_Low_Confidence_See_Results_Click:"MainlineSNRLowConfidenceSeeResults",Tenant_To_Homepage_Click:"TenantToHomepage",Tenant_To_ZQ_Click:"TenantToZQ",Tenant_To_BackArrow_Click:"TenantToBackArrow",Tenant_To_Chat_Click:"TenantToChat",Header_To_ZQ_Click:"HeaderToZQ"},r.notificationClickToTelemetryEventMap={Notification_Dismiss_Click:"DismissClick",Notification_Engagement_Click:"EngagementClick",Notification_Hide_BackgroundClick:"BackgroundClick"},r.pagePerfMatchConfig={"RMS:BfbCssBundle":function(n){return n.name.match(/\/rms\/BfbCssBundle\//)},"RMS:BfbPreBundle":function(n){return n.name.match(/\/rms\/BfbPreBundle\//)},"RMS:BfbBundle":function(n){return n.name.match(/\/rms\/BfbBundle\//)},"RMS:BfbDependencies":function(n){return n.name.match(/\/rms\/BfbDependencies\//)}},r}();n.WebTelemetry=r,function(n){n[n.Serp=-1]="Serp";n[n.BingAtWork=0]="BingAtWork";n[n.BfbController=1]="BfbController";n[n.Gleam=2]="Gleam";n[n.Upsell=3]="Upsell";n[n.Feedback=4]="Feedback";n[n.Paw=5]="Paw";n[n.SkypeClient=6]="SkypeClient";n[n.Person=7]="Person";n[n.Document=8]="Document";n[n.Bookmark=9]="Bookmark";n[n.Building=10]="Building";n[n.FloorPlan=11]="FloorPlan";n[n.OrgChart=12]="OrgChart";n[n.Group=13]="Group";n[n.RefQna=14]="RefQna";n[n.PowerBi=15]="PowerBi";n[n.BookmarkSuggest=16]="BookmarkSuggest";n[n.ExploreQuery=17]="ExploreQuery";n[n.Carousel=18]="Carousel";n[n.WebResult=19]="WebResult";n[n.PowerApps=20]="PowerApps";n[n.Conversation=21]="Conversation";n[n.EmbeddedController=22]="EmbeddedController";n[n.UserNotification=23]="UserNotification";n[n.SuggestedQueries=24]="SuggestedQueries";n[n.Site=25]="Site";n[n.ExplorePage=26]="ExplorePage";n[n.LandingPage=27]="LandingPage";n[n.Mainline=37]="Mainline";n[n.BingAtWorkHomepage=43]="BingAtWorkHomepage";n[n.BingAtWorkChromeNewTab=44]="BingAtWorkChromeNewTab";n[n.UnconsciousArrivalUpsell=45]="UnconsciousArrivalUpsell";n[n.LowConfidenceGleam=46]="LowConfidenceGleam";n[n.Rewards=47]="Rewards";n[n.RightRail=60]="RightRail";n[n.BingAtWorkNeo=70]="BingAtWorkNeo";n[n.ErrorPage=83]="ErrorPage";n[n.BceAdminControls=90]="BceAdminControls";n[n.Diag=999]="Diag"}(t=n.EventScope||(n.EventScope={}));n.writeConversationId=u;typeof bfbTel=="undefined"&&(bfbTel=new r,sj_evt.fire("bfbWebTelemetryExists"))})(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){function i(t,i,r,u){return{onSuccess:function(i,f,e){if(i&&(sj_evt.fire(t,i,r,f,e,n.getSucceededEventDetails(i,f,e)),u&&u.onSuccess))u.onSuccess(i)},onError:function(r,f,e){if(sj_evt.fire(i,r,f,e,n.getFailedEventDetails(r,f)),u&&u.onError)u.onError(r,f,e)}}}t.getResponseHandlers=i})(t=n.WebTelemetry||(n.WebTelemetry={}))}(BingAtWork||(BingAtWork={}));__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},function(n){function rt(n,t){var i={},r=n.flights,u;r&&r.length>0&&(i.variants=r.join());for(u in t)i[u]=t[u];return i}function ut(n,t){var i,r;if(t)for(i in t)r=n.indexOf("?")>-1?"&":"?",n+="".concat(r).concat(encodeURIComponent(i),"=").concat(encodeURIComponent(t[i]));return n}function ft(n){var t=7;switch(n){case 500:t=6;break;case 404:t=9;break;case 401:t=4;break;case 504:t=5;break;case 400:t=8}return t}function et(n){for(var r,t,f,u=[],i=1;i<arguments.length;i++)u[i-1]=arguments[i];if(!n)return n;for(r=n,t=0;t<u.length;t++)f=new RegExp("\\{".concat(t,"\\}"),"gm"),r=r.replace(f,arguments[t+1]);return r}function ot(t,i){try{return JSON.parse(t)}catch(r){return null}}function st(n,t,i){var r,u;for(i===void 0&&(i=7),r=n,u=0;r&&u<i;u++){if(r===t)return!0;r=r.parentElement}return!1}function ht(n){n!=null&&n.parentNode!=null&&n.parentNode.removeChild(n)}function c(n,t,i,r,u){r===void 0&&(r=0);n()||(t>1?setTimeout(function(){return c(n,t-1,i,r,u)},i+r):u&&u())}function o(n){if(typeof bfbTel!="undefined"&&bfbTel){n();return}sj_evt.bind("bfbWebTelemetryExists",n,!0,undefined,!0)}function ct(t){if(typeof n.Strings!="undefined"&&n.Strings){t();return}sj_evt.bind("BingAtWork:LocStrings",t,!0,null,!0)}function r(){try{return!!("localStorage"in _w&&_w.localStorage)}catch(n){return!1}}function l(t){var i=a(t);if(i){var u=s(t),r=i.cacheExpiryNum,f=i.cacheValueStr;if(!r||window.isNaN(r)||r<(new Date).getTime())h(u);else try{return JSON.parse(f)}catch(e){h(u)}}return undefined}function a(n){var r=s(n),t=wt(r);if(t){var i=t.split(";",2),u=i[0],f=i[1],e=Number(u);return{cacheValueStr:f,cacheExpiryNum:e}}return undefined}function lt(t,i,u,f,e,o,s){var c,h,v,y;if(o===void 0&&(o=!1),s===void 0&&(s=!1),!r())return i({onSuccess:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];u.onSuccess.apply(u,t);f.onSuccess.apply(f,t)},onError:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];u.onError.apply(u,t);f.onError.apply(f,t)}});if(n._isEventBind||(n._isEventBind=!0,sj_evt.bind("ajax.unload",function(){n._localStorageAutoRefreshHandlersBacklog={};n._localStorageOneOffHandlersBacklog={}},!0,null,!0)),n._localStoragePendingAutoRefreshes=n._localStoragePendingAutoRefreshes||{},n._localStorageAutoRefreshHandlersBacklog=n._localStorageAutoRefreshHandlersBacklog||{},n._localStorageOneOffHandlersBacklog=n._localStorageOneOffHandlersBacklog||{},u){if(n._localStorageAutoRefreshHandlersBacklog[t]&&n._localStorageAutoRefreshHandlersBacklog[t].length>0){n._localStorageAutoRefreshHandlersBacklog[t].push(u);return}n._localStorageAutoRefreshHandlersBacklog[t]=[u]}if(f){if(n._localStorageOneOffHandlersBacklog[t]&&n._localStorageOneOffHandlersBacklog[t].length>0){n._localStorageOneOffHandlersBacklog[t].push(f);return}n._localStorageOneOffHandlersBacklog[t]=[f]}if(c=l(t),c!=null&&!s){h=a(t);v=new Date(h===null||h===void 0?void 0:h.cacheExpiryNum);w(t,c,v,!0,i,e,o,!0);return}s;y=p(t,i,e,o);i(y)}function p(t,r,u,f){var e=s(t);return{onSuccess:function(i){var o=u&&u(i);o&&(w(t,i,o,!1,r,u,f),setTimeout(function(){return k(e,"".concat(o.getTime(),";").concat(JSON.stringify(i)))},0))},onError:function(){for(var u=[],r=0;r<arguments.length;r++)u[r]=arguments[r];i(n._localStorageAutoRefreshHandlersBacklog[t],function(n){n.onError&&n.onError.apply(n,u)});i(n._localStorageOneOffHandlersBacklog[t],function(n){n.onError&&n.onError.apply(n,u)});f||(n._localStorageAutoRefreshHandlersBacklog[t]=[]);n._localStorageOneOffHandlersBacklog[t]=[]}}}function s(t){return"".concat(n.localStorageCacheKeyPrefix).concat(t)}function w(t,r,u,f,e,o,s,h){if(i(n._localStorageAutoRefreshHandlersBacklog[t],function(n){n.onSuccess(r,undefined,h)}),s||(n._localStorageAutoRefreshHandlersBacklog[t]=[]),i(n._localStorageOneOffHandlersBacklog[t],function(n){n.onSuccess(r,undefined,h)}),n._localStorageOneOffHandlersBacklog[t]=[],s&&!n._localStoragePendingAutoRefreshes[t]){var c=Math.max(u.getTime()-(new Date).getTime()+v,f?y:0);n._localStoragePendingAutoRefreshes[t]=!0;setTimeout(function(){var i=p(t,e,o,s);e(i);n._localStoragePendingAutoRefreshes[t]=!1},c)}}function at(t,i,r){var u,f;return(r===void 0&&(r=";"),!((f=(u=n.SessionStorage)===null||u===void 0?void 0:u.isSupported)===null||f===void 0?void 0:f.call(u)))?undefined:vt(n.SessionStorage.getItem(t),i,r)}function vt(n,t,i){if(i===void 0&&(i=";"),!n)return undefined;var u=n.split(i,2),f=u[0],e=u[1],r=Number(f);return!r||window.isNaN(r)||r<=(new Date).getTime()-t?undefined:e}function yt(t,i,r){var u,f;(r===void 0&&(r=";"),(f=(u=n.SessionStorage)===null||u===void 0?void 0:u.isSupported)===null||f===void 0?void 0:f.call(u))&&n.SessionStorage.setItem(t,"".concat((new Date).getTime()).concat(r).concat(i))}function pt(t){try{sessionStorage.removeItem(t)}catch(i){}}function i(n,t){if(n)for(var i=0;i<n.length;i++)t(n[i])}function t(n,t){if(!n)return!1;for(var i=0;i<n.length;i++)if(n[i]===t)return!0;return!1}function b(){var n=function(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)};return n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n()}function k(n,t){if(r())try{localStorage.setItem(n,t)}catch(i){}}function wt(n){if(r())try{var t=localStorage.getItem(n);return t===null?undefined:t}catch(i){}return undefined}function h(t){if(r())try{localStorage.removeItem(t)}catch(i){}}function d(t){var c=t.condition,l=t.maxAttempts,u=t.baseIntervalInMillis,r=t.logName,e=t.callback,f=t.additionalIntervalPerAttemptInMillis,i=t.currentAttempt,s=t.timeOutCallback,h;f=f||0;i=i||0;c()?e!=null&&e():(i++,i<l?(h=__assign(__assign({},t),{baseIntervalInMillis:u+f,currentAttempt:i}),setTimeout(function(){return d(h)},u)):(o(function(){return bfbTel.logDiag("".concat(r,"_TimedOut"))}),s!=null&&s()))}function bt(t,i,r,u,f){for(var s,c,a,y,l=[],h=5;h<arguments.length;h++)l[h-5]=arguments[h];s=new Date;n._throttleRecords||(n._throttleRecords={});c=f.id;c||(c=f.id=b());try{a=JSON.stringify(r)}catch(p){return}var v=f.name||"(anonymous)",o="".concat(v,"_").concat(c,"_").concat(a),e=n._throttleRecords[o];if(e){if(e.totalCalls++,e.clusterCalls++,e.clusterCalls>t)if(y=s.getTime()-e.lastRunTime.getTime(),y>=i)e.clusterCalls=1,e.clusters++;else return e.throttledCalls++,e.lastThrottledCallStack=g("Call throttled"),u(),undefined}else n._throttleRecords[o]={totalCalls:1,clusterCalls:1,allowedCalls:0,throttledCalls:0,firstRunTime:s,lastRunTime:s,clusters:1,name:v};return n._throttleRecords[o].allowedCalls++,n._throttleRecords[o].lastRunTime=s,f.apply(void 0,l)}function g(n){return nt(new Error(n).stack)}function nt(n){return n&&n.replace(/\?.*/gi,"?<query string redacted>")}function kt(t){if(t===void 0&&(t=!0),!n._throttleRecords)return undefined;var r=[],u=Object.keys(n._throttleRecords);return i(u,function(i){var u=n._throttleRecords[i];(!t||u.throttledCalls>0)&&r.push(u)}),r}function dt(){n._throttleRecords={}}function gt(n,t){if(!n)return undefined;for(var i=0;i<n.length;i++)if(t(n[i]))return n[i];return undefined}function ni(n){return n&&n.length==0}function ti(t){try{return atob(t)}catch(i){}}function ii(t,i){typeof n.Localhost!="undefined"&&typeof n.Localhost.augmentMsbMtAjax=="function"&&n.Localhost.augmentMsbMtAjax(t,i)}function ri(n){if(!n.isOnWorkVertical)return undefined;var t=(window.location.hash||"").replace("#",""),i=t.indexOf("-");return t.substring(0,i>-1?i:t.length).toLocaleLowerCase()||"all"}function ei(t,i,r){var h=n.context.isErrBAbsorbEnabled,f,s;try{return i()}catch(e){if(f=e.name||e,s="Exception '".concat(f,"' caught at '").concat(t,"'")+(r?", called by '".concat(r,"'"):""),(_G.TEST_HOOKS_ENABLED||_G.TestEnv)&&alert(s),f&&(tt<fi&&(typeof u[f]=="undefined"||u[f]<ui)&&(o(function(){return bfbTel.logErr(n.EventScope.BingAtWork,s,e.message,"UncaughtError",e.stack)}),u[f]=typeof u[f]=="undefined"?1:u[f]+1,tt++),!h))throw e;}}function oi(t){if(!t)return{token:undefined,error:"Empty token string"};try{var i=t.split(".")[1],r=i.replace(/-/g,"+").replace(/_/g,"/"),u=decodeURIComponent(atob(r).split("").map(function(n){return"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)}).join(""));return{token:JSON.parse(u)}}catch(f){return{token:undefined,error:"Failed to parse token"}}}function si(){return/MSIE|Trident/.test(e())}function e(){return window.navigator.userAgent}function hi(){if(!window.performance)return!1;var n=window.performance.getEntriesByType("navigation");return n.length>0&&n[0].type==="back_forward"||window.performance.navigation.type===window.performance.navigation.TYPE_BACK_FORWARD}function ci(n){var t=function(){sb_st(n,100);sj_evt.unbind("aad:signedin",t)};sj_evt.bind("aad:signedin",t,!0,undefined,!0)}function it(){var n=e();return t(n,"OPR/")||t(n,"Opera")?"Opera":t(n,"PhantomJS")?"PhantomJS":t(n,"Edg")?"Edge":t(n,"Electron")?"Electron":t(n,"Chrome")?"Chrome":t(n,"Trident")?"MSIE":t(n,"Firefox")?"Firefox":t(n,"Safari")?"Safari":t(n,"SkypeShell")?"SkypeShell":"Unknown"}function li(){var r,n=e(),t=it(),i;return t==="MSIE"?r=ai(n):t==="Edge"?(i=f(n,t),r=i==="Unknown"?f(n,"Edg"):i):t==="Opera"?(i=f(n,t),r=i==="Unknown"?f(n,"OPR"):i):r=f(n,t),r}function ai(n){var i=n.match(new RegExp("MSIE ([\\d,.]+)")),t;return i?i[1]:(t=n.match(new RegExp("rv:([\\d,.]+)")),t?t[1]:"Unknown")}function f(n,t){t==="Safari"&&(t="Version");var i=n.match(new RegExp(t+"/([\\d,.]+)"));return i?i[1]:"Unknown"}var v,y;n.bawSourceName="BingAtWork";n.msPerDay=864e5;n.getRequestMetadata=rt;n.mergeArgsIntoUrl=ut;n.getError=ft;n.strFormat=et;n.tryParseJson=ot;n.hasAncestorElement=st;n.removeElement=ht;n.retryPoll=c;n.whenWebTelemetryExists=o;n.whenLocStringsAvailable=ct;n.isLocalStorageSupported=r;n.getCacheValueIfValid=l;n.localStorageCacheKeyPrefix="MSBLS_";v=18e4;y=3e4;n.withLocalStorageCache=lt;n.getSessionStorage=at;n.writeSessionStorage=yt;n.removeSessionStorageItem=pt;n.forEach=i;n.includes=t;n.generateGuid=b;n.setItemForLocalStorage=k;n.removeItem=h;n.poll=d;n.throttle=bt;n.getSanitizedCallStack=g;n.redactQueryStrings=nt;n.getThrottleRecords=kt;n.resetThrottleRecords=dt;n.find=gt;n.isEmpty=ni;n.decodeBase64=ti;n.augmentMsbMtAjax=ii;n.getStartedEventDetails=function(){return{startTime:new Date,startTimeStartDuration:performance.now()}};n.getSucceededEventDetails=function(n,t,i){return{endTime:new Date,endTimeStartDuration:performance.now(),response:n,headers:t,status:200,isFromCache:i}};n.getFailedEventDetails=function(n,t){return{endTime:new Date,endTimeStartDuration:performance.now(),error:n,status:t}};n.getLoweredWorkSerpVerticalDomain=ri;var u={},tt=0,ui=5,fi=30;n.withErrorBoundary=ei;n.parseJwt=oi;n.isHostIE=si;n.getUserAgent=e;n.isBackForwardNavigation=hi;n.bindForAad=ci;n.getBrowserName=it;n.getBrowserVersion=li}(BingAtWork||(BingAtWork={})),function(n){function o(t,i,f){var e=function(){if(u){var i=[t.url,t.requestType],e=function(){t.onError&&t.onError(7,0,"throttled")};n.throttle(10,1e4,i,e,r,t,f)}else r(t,f)};(n.context===null||n.context===void 0?void 0:n.context.isErrorBoundaryEnabled)&&n.withErrorBoundary?n.withErrorBoundary("sendAjax",e,i):e()}function r(t,r){var y,a,d,g,h,nt;if(t!=null){var tt=t.timeout,p=t.onSuccess,c=t.onError,l=t.url,w=t.body,it=t.tries,ft=t.requestType,b=t.headers,et=t.convertPropertiesToPascalCase,k=t.accessToken,o=window===null||window===void 0?void 0:window.parent;f&&(a=(y=o===null||o===void 0?void 0:o.BingAtWork)===null||y===void 0?void 0:y.wsb,k=t.accessToken||(a===null||a===void 0?void 0:a.wsbAccessToken));var u=e?typeof(o===null||o===void 0?void 0:o.sj_gx)=="function"?o===null||o===void 0?void 0:o.sj_gx():new XMLHttpRequest:sj_gx(),rt=ft||"GET",ut=function(){return u.open(rt,l,!0)},v=n.redactQueryStrings(l);if(ut(),u.withCredentials=!t.disableWithCredentials,d=function(){return c&&c(5,504,null)},u.ontimeout=(n.context===null||n.context===void 0?void 0:n.context.isErrorBoundaryEnabled)&&n.withErrorBoundary?function(){return n.withErrorBoundary("Ajax.ontimeout",d,"Ajax ".concat(v))}:d,u.timeout=tt==null?0:tt,g=it||1,h=function(t,i,r,u){n.whenWebTelemetryExists(function(){return bfbTel.logDiag(u,{url:l,reason:i})});c!=null&&c(i,t,r)},k!=null&&u.setRequestHeader("Authorization","Bearer ".concat(k)),s()&&rt==="POST"&&u.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),b)for(nt in b)u.setRequestHeader(nt,b[nt]);u.onreadystatechange=function(){var t,f,s,c,e,o;if(u.readyState===4)if(u.status===200){if(p!=null){if(t=null,f={},u.responseText!=null&&u.responseText!=="")try{t=r?u.responseText:JSON.parse(u.responseText)}catch(l){(n.context===null||n.context===void 0?void 0:n.context.isErrorBoundaryEnabled)&&n.withErrorBoundary?n.withErrorBoundary("Ajax.onAjaxError",function(){return h(-1,10,u.responseText,"Bad data")},"Ajax ".concat(v)):h(-1,10,u.responseText,"Bad data");return}if(u.HEADERS_RECEIVED)try{s=u.getAllResponseHeaders();c=s.trim().split(/[\r\n]+/);c.forEach(function(n){var t=n.split(": "),i=t.shift(),r=t.join(": ");f[i]=r})}catch(a){}t=et?i(t):t;(n.context===null||n.context===void 0?void 0:n.context.isErrorBoundaryEnabled)&&n.withErrorBoundary?n.withErrorBoundary("Ajax.onSuccess",function(){return p(t,f)},"Ajax ".concat(v)):p(t,f)}}else--g>0?(u.abort(),ut(),u.send(w)):(e=n.getError(u.status),o="Ajax call failed with status ".concat(u.status,". No retries available."),(n.context===null||n.context===void 0?void 0:n.context.isErrorBoundaryEnabled)&&n.withErrorBoundary?n.withErrorBoundary("Ajax.onAjaxError",function(){return h(u.status,e,u.responseText,o)},"Ajax ".concat(v)):h(u.status,e,u.responseText,o))};u.send(w)}}function i(n){return n===null?null:n===undefined?undefined:typeof n=="number"||typeof n=="string"||typeof n=="boolean"?n:Array.isArray(n)?n.map(i):Object.keys(n).reduce(function(t,r){var u="".concat(r[0].toUpperCase()).concat(r.slice(1));return t[u]=typeof n[r]=="object"?i(n[r]):n[r],t},{})}function s(){return typeof window=="undefined"||!window.navigator||!window.navigator.userAgent?!1:window.navigator.userAgent.indexOf("PhantomJS")>-1}var t=n.context&&n.context,u=t===null||t===void 0?void 0:t.isThrottlingEnabled,f=(t===null||t===void 0?void 0:t.wsb)||(t===null||t===void 0?void 0:t.miniSerp),e=t===null||t===void 0?void 0:t.miniSerp;n.sendAjax=o}(BingAtWork||(BingAtWork={}));BingAtWork.Wsb=BingAtWork.Wsb||{};BingAtWork.Wsb.sendAjax=function(n,t,i){return BingAtWork.sendAjax(n,i,t)},function(n){var t;(function(t){function i(t,i,r){var u=n.getRequestMetadata(t,r);return n.mergeArgsIntoUrl(i,u)}function r(t,i,r,u,f,e,o){var s={url:t,accessToken:e,requestType:"POST",body:JSON.stringify(i),timeout:u,headers:f,onSuccess:r.onSuccess,onError:r.onError};n.augmentMsbMtAjax(s,"caller: sendPostRequest, file: ServiceHelpers");n.sendAjax(s,"caller: sendPostRequest, file: ServiceHelpers",o)}t.addArgsToUrl=i;t.sendPostRequest=r})(t=n.Service||(n.Service={}))}(BingAtWork||(BingAtWork={}));__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},function(n){function i(n,t){if(t===void 0&&(t=0),n==null)throw new Error("arg ".concat(t," is null"));return n}function c(t,i){try{var r=t();return typeof r=="undefined"||r===null?i:r}catch(u){return i}}function t(n){var t=new RegExp("^\\s*$");return n==null||t.test(n)}function l(n,t){var r=i(n).toLowerCase(),u=i(t,1).toLowerCase();return r.indexOf(u)>=0}function a(t,i){var f,r;return t==null?null:i?(r=u(t.ScopeAnalysis),{UserInfo:t.UserInfo,Items:r!=null&&r.QasIndexItems!=null&&r.QasIndexItems.length>0?JSON.parse(r.QasIndexItems[0].Metadata):null}):(f=n.getCommandItemGroups(t),f!=null?f[0]:null)}function u(n){return n==null||n.length===0?null:n[0]}function v(n,t){return{onSuccess:n,onError:t.onError}}function y(n){return n.length>1?n[1]:null}function p(n){var t=new Date;return t.setTime(t.getTime()+n*6e4),t}function f(i){if(i=e(i),t(i))return"";var r=n.getParameterByName("ue",i),u=t(r)?n.getParameterByName("q",i):r;return t(u)?"":u.trim()}function w(n){var i=f(n),u;return t(i)?"":(u=r(i.replace(/[<>\(\)\'\"]+/gi,"")),t(u))?"":r(i)}function b(i){if(i=e(i),t(i))return"";var r=n.getParameterByName("form",i);return r==null?null:r.trim()}function r(n){return n.replace(/^[\`\!\@\#\$\%\^\&\*\)\_\+\=\-\,\.\/\;\:\[\]\\\{\}\|\~\?\¿]+/gi,"").replace(/[\`\!\@\#\$\%\^\&\*\(\_\+\=\-\,\.\/\;\:\[\]\\\{\}\|\~\?\¿]+$/gi,"").replace(/('s )/gi," ").replace(/[ ]+/gi," ").toLowerCase()}function e(n){return t(n)?_w.location.href:n}function k(n){return n==null?"":_G!=null&&_G.Mkt!=null?n.toLocaleString(_G.Mkt).replace(/\.00$/,""):n.toString()}function d(n,t){return n==null||n.ScopeAnalysis==null||n.ScopeAnalysis.length<1?!1:t==null||t.length<1?!1:n.ScopeAnalysis.some(function(n){return t.indexOf(n.Domain)>-1})}function g(t,i){var r=n.isLocalStorageSupported()?localStorage.getItem(n.LocalStorageEnums.pinned.key):null,u=r==null?i:r===n.LocalStorageEnums.pinned["true"];return(t&&u)===!0}function nt(n,t,i){t===void 0&&(t="jpeg");i===void 0&&(i=!0);var r="data:image/".concat(t,";base64,").concat(n);return i&&r?"url(".concat(r,")"):r}function tt(n,t){var i=t[n];return i==null?undefined:t[i]}function it(t){var i=n.getMFASignInUrl(t);i!=null&&window.location.replace(i)}function rt(t){var i,r,u;return(t=(r=(i=t===null||t===void 0?void 0:t.replace(/\([\s\S]*?\)/g,""))===null||i===void 0?void 0:i.replace(/\[[\s\S]*?\]/g,""))===null||r===void 0?void 0:r.replace(/\{[\s\S]*?\}/g,""),n.includes(t,","))?((u=t===null||t===void 0?void 0:t.split(",")[1])===null||u===void 0?void 0:u.trim())||"":(t===null||t===void 0?void 0:t.split(" ")[0])||""}function ut(t){var e,o,s,l=n.context.isWebGroupAnswerDisabledClientSide,u,i,r,f,h,c;return l?(u=[],i=[],(e=t.AnswerEntitySets)===null||e===void 0?void 0:e.forEach(function(n){var r=n.EntityType==="Group",t;r?n.ResultSets.forEach(function(n){n.Results.forEach(function(n){u.push(n.Id)})}):n.EntityType==="People"?(t=[],n.ResultSets.forEach(function(n){var i=[];n.Results.forEach(function(n){n.Source.PeopleType==="Group"?u.push(n.Id):i.push(n)});i.length&&t.push(__assign(__assign({},n),{Results:i}))}),t.length&&i.push(__assign(__assign({},n),{ResultSets:t}))):i.push(n)}),r=[],(o=t.WholePageRankings)===null||o===void 0?void 0:o.forEach(function(n){var t=[];n.EntityCards.forEach(function(n){var i,r=(i=n.EntityIds)===null||i===void 0?void 0:i.filter(function(n){return u.indexOf(n)===-1});(r===null||r===void 0?void 0:r.length)&&t.push(n)});t.length&&r.push(n)}),f=[],(s=t.Ranking)===null||s===void 0?void 0:s.EntityCards.forEach(function(n){var t,i=(t=n.EntityIds)===null||t===void 0?void 0:t.filter(function(n){return u.indexOf(n)===-1});(i===null||i===void 0?void 0:i.length)&&f.push(n)}),h=f.length?__assign(__assign({},t.Ranking),{EntityCards:f}):undefined,c=__assign(__assign({},t),{AnswerEntitySets:(i===null||i===void 0?void 0:i.length)?i:undefined,Ranking:h,WholePageRankings:(r===null||r===void 0?void 0:r.length)?r:undefined}),c):t}function o(){var t=n.context,i=t.wsb,r=t.isOnWorkVertical,u=t.isSharedSerpWorkBundlesEnabled;return!!(!i&&r&&u)}function h(){s=!0;sj_evt.unbind("bfbRouterInitializedEvent",h)}function ft(){sj_evt.bind("bfbRouterInitializedEvent",h,!0)}function et(){return s&&o()}function ot(n){sj_evt.fire("bfbUrlChangeRequeryEvent",n)}n.chk=i;n.safeGet=c;n.nullOrWs=t;n.containIgnoreCase=l;n.getResp=a;n.getFirstScopeAnalysis=u;n.cpyErr=v;n.secondOrNull=y;n.getDateAddMinutes=p;n.getRawQuery=f;n.getNormalizedQuery=w;n.getFormCodeFromUrl=b;n.normalizeQuery=r;n.localizeNumber=k;n.hasDomain=d;n.isPinned=g;n.imgSrc=nt;n.enumPropertyToValue=tt;n.redirectToMFASignIn=it;n.getFirstNameOrFullName=rt;n.removeDisabledAnswersFrom3sResponse=ut;n.isSharedSerpOnlyBundle=o;var s=!1;n.initAutoSuggest=ft;n.isMsbHandlingAutoSuggestRequery=et;n.handleAutoSuggestRequery=ot}(BingAtWork||(BingAtWork={}));__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},function(n){var t;(function(t){var i=function(){function t(t,i){var u=this,r;this.delayNotificationRequestMilliseconds=2500;this.isActionPending=!1;this.pendingRequest=null;this.config=t;this.userData=i;this.userDataApiUrl="".concat(t.apiUriBase).concat(t.userDataApiUri);r=t.flights&&!n.isEmpty(t.flights)?",".concat(encodeURIComponent(t.flights.join())):"";this.userDataDebugApiUrl=t.userDataDebugApiUri?"".concat(t.apiUriBase).concat(t.userDataDebugApiUri,"?variants=testenabled").concat(r):undefined;this.firePendingRequest=this.firePendingRequest.bind(this);this.notificationsApiUrl="".concat(this.userDataApiUrl,"/notifications");this.cvid=typeof _G!="undefined"?_G.IG:undefined;_w.addEventListener("beforeunload",function(){return u.firePendingRequest()})}return t.prototype.notificationAction=function(n,t){this.notificationActionBatch([n],t)},t.prototype.firePendingRequest=function(){var n=this.pendingRequest;this.pendingRequest=null;this.isActionPending=!1;n&&this.notificationActionBatch(n.actions,n.onResponse)},t.prototype.notificationActionBatch=function(t,i){var r=this;if(t!=null&&t.length!==0){if(this.isActionPending){this.addToPending(t,i);return}this.isActionPending=!0;this.addToPending(t,i);setTimeout(function(){var n=r.pendingRequest,i=n.actions,t;r.pendingRequest=null;t={onSuccess:function(t){try{n.onResponse&&n.onResponse.onSuccess&&n.onResponse.onSuccess(t)}finally{r.firePendingRequest()}},onError:function(t){try{n.onResponse&&n.onResponse.onError&&n.onResponse.onError(t)}finally{r.firePendingRequest()}}};r.notificationRequest(t,{actions:i})},this.delayNotificationRequestMilliseconds)}},t.prototype.addToPending=function(n,t){if(this.pendingRequest==null){this.pendingRequest={actions:n,onResponse:t};return}if(this.pendingRequest.actions=this.pendingRequest.actions.concat(n),t){var i=this.pendingRequest.onResponse&&this.pendingRequest.onResponse.onSuccess,r=this.pendingRequest.onResponse&&this.pendingRequest.onResponse.onError;t.onSuccess&&(i=i?function(n){i(n);t.onSuccess(n)}:t.onSuccess);t.onError&&(r=r?function(n){r(n);t.onError(n)}:t.onError);this.pendingRequest.onResponse={onSuccess:i,onError:r}}},t.prototype.clear=function(t,i){var r={url:t?"".concat(this.userDataApiUrl,"/notifications"):this.userDataApiUrl,requestType:"DELETE",onSuccess:i&&i.onSuccess||function(){console.log("UserDataClient: succeed to clear user data")},onError:i&&i.onError||function(){console.log("UserDataClient: fail to clear user data")}};n.sendAjax(r,"caller: clear, file: UserDataVNextClient")},t.prototype.getUserData=function(t){if(this.userDataDebugApiUrl){var i={url:this.userDataDebugApiUrl,requestType:"GET",onSuccess:t&&t.onSuccess||function(n){console.log("UserDataClient: Current UserData: ".concat(n));console.log(n)},onError:t&&t.onError||function(n,t,i){console.log("UserDataClient: fail to GetUserData, reason:".concat(n,", statusCode:").concat(t,", response:").concat(i," "))}};n.sendAjax(i,"caller: clear, file: UserDataVNextClient")}else throw new Error("GetUserData not permitted for the current user");},t.prototype.setUserData=function(t,i){if(this.userDataDebugApiUrl){var r=JSON.stringify(t),u={url:this.userDataDebugApiUrl,requestType:"POST",body:r,onSuccess:i&&i.onSuccess||function(){console.log("UserDataClient: successfully updated UserData")},onError:i&&i.onError||function(n,t,i){console.log("UserDataClient: fail to SetUserData, reason:".concat(n,", statusCode:").concat(t,", response:").concat(i," "))}};n.sendAjax(u,"caller: clear, file: UserDataVNextClient")}else throw new Error("SetUserData not permitted for the current user");},t.prototype.notificationRequest=function(t,i){var r,u,f;i===void 0&&(i=null);r={};this.cvid!==undefined&&(r.cvid=this.cvid);u="".concat(this.userDataApiUrl,"/notifications");f="PUT";this.config.notificationDataUpdateApiUri&&(u="".concat(this.config.apiUriBase).concat(this.config.notificationDataUpdateApiUri),f="POST");var o=n.getRequestMetadata(this.config,r),s=n.mergeArgsIntoUrl(u,o),h=function(r,u){if(sj_evt.fire("bfbUpdateNotifications",r,i,u,!1,n.getSucceededEventDetails(r,u,!1)),t&&t.onSuccess)t.onSuccess(r)},c=function(i,r,u){if(sj_evt.fire("bfbUpdateNotifications_Failed",i,r,u,n.getFailedEventDetails(i,r)),t&&t.onError)t.onError(i)},e={url:s,timeout:this.config.userDataTimeout,onSuccess:h,onError:c};e.body=JSON.stringify(i);e.requestType=f;sj_evt.fire("bfbUpdateNotifications_Started",n.getStartedEventDetails());n.sendAjax(e,"caller: notificationRequest, file: UserDataVNextClient")},t.prototype.getNotifications=function(t,i){var r={};this.cvid!==undefined&&(r.cvid=this.cvid);var f=__assign({},n.getRequestMetadata(this.config,r)),e=n.mergeArgsIntoUrl(this.notificationsApiUrl,f),o=JSON.stringify(t),u={url:e,requestType:"POST",body:o,timeout:this.config.userDataTimeout,onSuccess:i&&i.onSuccess,onError:i&&i.onError};n.augmentMsbMtAjax(u,"caller: getNotifications, file: UserDataVNextClient");this.cachedRequest=t;sj_evt.fire("bfbGetNotifications_Started",n.getStartedEventDetails());n.sendAjax(u,"caller: getNotifications, file: UserDataVNextClient")},t.prototype.broadcast=function(n){this.cachedNotificationResponse=n;this.broadcastImpl()},t.prototype.broadcastImpl=function(){sj_evt.fire("bfbGetNotifications",this.cachedNotificationResponse,this.cachedRequest,n.getSucceededEventDetails(this.cachedNotificationResponse,null,!1))},t}();t.UserDataVNextClient=i})(t=n.Service||(n.Service={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){var i=function(){function t(){var t=localStorage.getItem("UserData");if(t!=null)try{this.localUserData=JSON.parse(t)}catch(i){this.isInvalid=!0}this.localUserData==null&&(this.localUserData={notifications:[]})}return t.prototype.isValid=function(){return!this.isInvalid},t.prototype.getNotificationInfo=function(n,t){var i,r,u;if(this.isInvalid)return null;if(i=this.localUserData.notifications[n],i!=null)if(t>0&&i.lastImpressionTimestamp){if(r=(new Date).getTime(),u=(r-i.lastImpressionTimestamp)/1e3,u<t)return i}else return i;return this.localUserData.notifications[n]={impressionCount:0,suppressedCount:0,dismissedCount:0},this.localUserData.notifications[n]},t.prototype.logNotificationAction=function(t,i){if(!this.isInvalid){var r=this.getNotificationInfo(t,0),u=(new Date).getTime();switch(i){case 0:r.impressionCount++;r.firstImpressionTimestamp==null&&(r.firstImpressionTimestamp=u);r.lastImpressionTimestamp=u;break;case 3:r.suppressedCount++;break;case 2:r.dismissedTimestamp=u;r.dismissedCount==null?r.dismissedCount=1:r.dismissedCount++;break;default:return}localStorage.setItem("UserData",JSON.stringify(this.localUserData))}},t.prototype.clear=function(){localStorage.removeItem("UserData")},t}();t.LocalUserDataClient=i})(t=n.Service||(n.Service={}))}(BingAtWork||(BingAtWork={})),function(n){function t(t){var f=n.context.isStabilityShadowEnabled,r,u;if(f&&t){var e=t.url,o=t.token,s=t.headers,h=t.request;n.stabilityClient||(n.stabilityClient=new n.Service.StabilityClient(n.context.mtCfg));r=n.stabilityClient.buildShadowRequest(i(e),o,s,JSON.stringify(h));u={onSuccess:function(){sj_evt.fire("bfbStabilityShadow")},onError:function(t,i,r){sj_evt.fire("bfbStabilityShadowFailed",t,i,r,n.getFailedEventDetails(t,i))}};n.stabilityClient.shadow(r,u)}}function i(n){var t=new RegExp("^/baw/substrate/api","i");return n.replace(t,"https://substrate.office.com/search/api")}n.stabilityShadow=t}(BingAtWork||(BingAtWork={})),function(n){n.bundleEvents==null&&(n.bundleEvents={});var t=function(){function t(t,i,r){var f,u,e,o;if(i===void 0&&(i=["ajax.load"]),f=this,this.ajaxStateWasLast=!1,this.eventToFire=t,this.ajaxSerpCallback=r,this.ready(!1,!1,[]),!n.bundleEvents[t]){for(u=0,e=i;u<e.length;u++)o=e[u],sj_evt.bind(o,function(n){return f.readyAjax(n)});sj_evt.bind("ajax.state",function(){return f.ajaxStateWasLast=!0})}n.bundleEvents[t]=!0}return t.prototype.ready=function(t,i,r){this.ajaxStateWasLast=!1;sj_evt.fire(this.eventToFire);t&&this.ajaxSerpCallback!=null&&this.ajaxSerpCallback(r[1],i)},t.prototype.readyAjax=function(t){if(t!=null&&t.length>0){this.properAjaxEvent==null&&(this.properAjaxEvent=t[0]);var r=!this.ajaxStateWasLast&&this.properAjaxEvent===t[0],i=this.ajaxStateWasLast&&t[0]==="ajax.load";(r||i)&&this.ready(!0,i,t)}},t}();n.BundleReady=t}(BingAtWork||(BingAtWork={})),function(n){function e(){return"/orgid/simplesignout"}function o(n,t,i,r){var u="/work/search?q=".concat(encodeURIComponent(n),"&ue=").concat(encodeURIComponent(t));return r!=null&&(u+="&bfbqi=".concat(r)),i!=null&&(u+="&FORM=".concat(encodeURIComponent(i))),u}function s(t,i,r){return"/work/search?q=".concat(encodeURIComponent(t),"&bfbqi=").concat(n.QueryIntent.Group,"&bfbgid=").concat(encodeURIComponent(i),"&FORM=").concat(encodeURIComponent(r))}function h(t){return"/work/search?q=building%20".concat(encodeURIComponent(t),"&ue=&bfbqi=").concat(n.QueryIntent.Building,"&FORM=BAWBMD")}function c(t,i,r){return n.strFormat(t,encodeURIComponent(i),encodeURIComponent(r||""))}function l(t,i,r,u){return n.strFormat(t,encodeURIComponent(i),encodeURIComponent(r),encodeURIComponent(u||""))}function a(n,t){var i="/work/search?q=".concat(encodeURIComponent(n));return t!=null&&(i+="&FORM=".concat(encodeURIComponent(t))),i}function v(n,t){return"/business/mtr/iras?e=".concat(n,"&c=").concat(t)}function y(i){var u=window.location.href,h=t("login_hint",u)||"",c=t("domain_hint",u)||"",l=t("redir",u),e=(Number(l)||1)+1,a=t("mfaredir",u),o=(Number(a)||1)+1,s;if(!(e>6)&&!(o>2))return u=f("itrid",u),u=r("redir","".concat(e),u),u=r("mfaredir","".concat(o),u),s=encodeURIComponent(u),n.strFormat(i,s,h,c,!0)}function u(n){var t=n.replace(/\+/g," ");return decodeURIComponent(t)}function t(n,t){var r=n.toLowerCase(),u=i(t);return u[r]}function r(t,r,u){var e=t.toLowerCase(),o=u.substring(0,u.indexOf("?")),f=i(u);return f[e]=r,n.mergeArgsIntoUrl(o,f)}function f(t,r){var f=t.toLowerCase(),e=r.substring(0,r.indexOf("?")),u=i(r);return delete u[f],n.mergeArgsIntoUrl(e,u)}function p(t){if(n.nullOrWs(t))return"";var i=new RegExp(/(\D*x).*$/ig),r=new RegExp(/\D/g);return"tel:+"+t.replace(i,"").replace(r,"")}function w(n){return"mailto:".concat(n)}function b(n,t,i,r){return t&&!r?i?"ms-sfb://start":"ms-sfb://chat?id=".concat(n):"sip:".concat(n)}function k(){return"/business/uid"}function i(n){var i=n.substring(n.indexOf("?")+1),t={};return i.split("&").forEach(function(n){var i=n.split("=");i!=null&&i[0]!=null&&i[1]!=null&&(t[i[0].toLowerCase()]=u(i[1]))}),t}n.getSignOutUrl=e;n.getUserUrl=o;n.getGroupUrl=s;n.getBuildingMapUrl=h;n.getRoomInfoUrl=c;n.getFloorPlanUrl=l;n.getWorkSearchUrl=a;n.getMtrUrl=v;n.getMFASignInUrl=y;n.decodeQuery=u;n.getParameterByName=t;n.updateParameterByName=r;n.deleteParameterByName=f;n.getPhoneNumberUrl=p;n.getEmailUrl=w;n.getMessengerUrl=b;n.getFetchUidUrl=k;n.buildQueryParameters=i}(BingAtWork||(BingAtWork={}));__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)};__spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},function(n){var t;(function(t){var i;(function(t){function f(t,i,r,u,f,e,s,h){var a=n.context,b=a.conversationId,k=a.logicalId,v=a.ssCfg,d=a.culture,g=a.uiCulture,nt=a.timeZone,tt=a.isSubstrateTimeZoneEnabled,it=a.isSubstrateUICultureEnabled,rt=a.isEduAssignmentESEnabled,ut=a.isSerpLiteEnabled,y=a.formCode,p=a.muid,ft=v.searchScenario,et=v.defaultScenario,ot=e||ft||et,w=typeof _G.IG!="undefined"&&_G.IG?_G.IG:undefined;return __assign(__assign(__assign(__assign({EntityRequests:ut?[]:c(t,i,r,u,s,h),Cvid:b,LogicalId:k,Scenario:{Dimensions:__spreadArray(__spreadArray(__spreadArray([{DimensionName:"QueryType",DimensionValue:o(t)},{DimensionName:"FormFactor",DimensionValue:"Web"}],y?[{DimensionName:"FormCode",DimensionValue:y}]:[],!0),p?[{DimensionName:"Muid",DimensionValue:p}]:[],!0),w?[{DimensionName:"ImpressionGuid",DimensionValue:w}]:[],!0),Name:ot},TextDecorations:"Off",TimeZone:tt?nt:"UTC"},rt&&{TimeZoneOffsetInMinutes:-1*(new Date).getTimezoneOffset()}),{Culture:d}),it&&{UICulture:g}),{QueryAlterationOptions:l(f)})}function i(n){return n==="External"}function e(n,t){return n&&t?"ItemId:".concat(n," OR label_title:").concat(t):t}function o(n){switch(n){case"File":case"Site":return n;case"FileAndSite":default:return"AllResults"}}function s(n,t){return t?"".concat(n," AND (").concat(t,")"):n}function h(t,i,r){return!t||r===undefined||r==null?i:r===n.ConnectorResultsExperience.INTERLEAVED}function c(t,f,o,c,l,y,p){var w=n.context,it=w.isAllEQTEnabled,rt=w.is3sDisplayQueryStringEnabled,ut=w.query,ft=w.isCustomRefinerPrefechEnabled,et=w.isConnectorInterleavingEnabled,ot=w.consumeAdminUXSettingForCRE,st=w.isSharePointResultsCustomizationEnabled,b=h(ot,et,p),k=rt?ut:f,d=c||10,g=[{EntityType:"File",From:0,Size:d,Query:{DisplayQueryString:k,QueryString:f,QueryTemplate:it?s(r(t),o):r(t)},Sort:[{Field:"PersonalScore",SortDirection:"Desc"}],Fields:v,IdFormat:0,ContentSources:t==="Site"?["SharePoint"]:["OneDriveBusiness","SharePoint"],ResultsMerge:{Type:"Interleaved"},EnableQueryUnderstanding:!1,EnableSpeller:!1,ExtendedQueries:[{SearchProvider:"SharePoint",Query:{Culture:a,EnableQueryRules:!1,TrimDuplicates:!1,BypassResultTypes:!0,ProcessBestBets:!1,ProcessPersonalFavorites:!1,EnableInterleaving:!1,EnableMultiGeo:!0,SourceId:"8413CD39-2156-4E00-B54D-11EFD9ABDB89"}}],HitHighlight:{HitHighlightedProperties:t==="Site"?["Title"]:["HitHighlightedSummary"],SummaryLength:200},Aggs:ft?u(l):undefined,PreferredResultSourceFormat:st?"AdaptiveCardTemplateBinding":undefined}],nt,tt;return t=="All"&&(nt=b?d:2,tt=__assign(__assign({},b&&{ResultsMerge:{Type:"Interleaved"}}),{BypassResultTypes:!1,EntityType:"External",From:0,Size:nt,PreferredResultSourceFormat:"AdaptiveCardTemplateBinding",Query:{DisplayQueryString:k,QueryString:i(y&&y.intent)?e(y===null||y===void 0?void 0:y.itemId,f):f},Sort:[{Field:"Score",SortDirection:"Desc"}],ContentSources:i(y&&y.intent)&&y.contentSource?[y.contentSource]:["Connectors"],HitHighlight:{HitHighlightedProperties:["HitHighlightedSummary"],SummaryLength:200}}),g.push(tt)),g}function l(t){var u=n.context,e=u.isNLFileSearchEnabled,i=u.isBingSpellerEnabled,f=u.isNLRecourseEnabled,o=u.isSharedSerpAllVerticalEnabled,r;return o?{EnableSuggestion:i,EnableAlteration:!0,SupportedRecourseDisplayTypes:["ServiceSideRecourseLink"]}:!e&&!i?undefined:(r=[],i&&(r.push("Suggestion"),r.push("NoResultModification")),f&&!t&&r.push("NoRequeryModification"),__assign({EnableSuggestion:i,EnableAlteration:!0},(i||f)&&{SupportedRecourseDisplayTypes:r}))}function r(t){var r=n.context.culture,i;switch(t){case"File":i=y;break;case"Site":i=p;break;case"All":case"FileAndSite":default:i=w}return!r||(i=i.concat(n.strFormat(b,r.toLowerCase()))),i}function u(t){if(!t)return undefined;var i={};return t.map(function(n){var t;((t=n.layout)===null||t===void 0?void 0:t.fieldName)&&(i["".concat(n.layout.fieldName)]={histogram:{field:n.layout.fieldName}})}),i}t.buildSubstrateQueryRequest=f;t.mapAllVerticalConfigRefiners=u;var a=1033,v=[".callerStack",".correlationId",".mediaBaseUrl",".spResourceUrl",".thumbnailUrl","AuthorOWSUSER","ContainerTypeId","ContentClass","ContentTypeId","Created","DefaultEncodingURL","DepartmentId","Description","DocId","EditorOWSUSER","FileExtension","FileType","Filename","GeoLocationSource","HitHighlightedSummary","IsContainer","IsHubSite","LastModifiedTime","LinkingUrl","ListID","MediaDuration","ModifiedBy","ParentLink","Path","PiSearchResultId","PictureThumbnailURL","ProgID","PromotedState","RelatedHubSites","SPWebUrl","SecondaryFileExtension","ServerRedirectedPreviewURL","ServerRedirectedUrl","SiteId","SiteLogo","SiteTemplateId","SiteTitle","Title","UniqueID","UniqueId","ViewCount","ViewsLifeTimeUniqueUsers","WebId","isDocument","isexternalcontent","ListTemplateTypeId","PrivacyIndicator"],y="({searchterms}) (NOT (Title:OneNote_DeletedPages OR Title:OneNote_RecycleBin) AND NOT SecondaryFileExtension:onetoc2 AND NOT FileExtension:vtt AND NOT ContentClass:ExternalLink AND NOT (ContentClass:STS_List_DocumentLibrary AND SiteTemplateId:21) AND NOT ((filetype:aspx OR filetype:htm OR filetype:html OR filetype:mhtml)) AND isDocument:1 OR ((ContentTypeId:0x010100F3754F12A9B6490D9622A01FE9D8F012 OR ContentTypeId:0x0120D520A808*) OR (SecondaryFileExtension:wmv OR SecondaryFileExtension:avi OR SecondaryFileExtension:mpg OR SecondaryFileExtension:asf OR SecondaryFileExtension:mp4 OR SecondaryFileExtension:ogg OR SecondaryFileExtension:ogv OR SecondaryFileExtension:webm OR SecondaryFileExtension:mov)) OR (FileType:bmp OR FileType:gif OR FileType:ico OR FileType:jpeg OR FileType:jpg OR FileType:png OR FileType:svg OR FileType:tiff OR FileType:tif OR FileType:heic) OR (ContentTypeId:0x012000*)) AND NOT (ContentTypeId:0x0101009D1CB255DA76424F860D91F20E6C4118* AND PromotedState:2)",p="({searchterms}) (ContentClass:STS_Site OR ContentClass:STS_Web) AND NOT (ContentClass:STS_Site AND SiteTemplateId:21) AND NOT (ContentClass:STS_Site AND SiteTemplateId:22) AND NOT WebTemplate:SPSPERS AND NOT (Title:OneNote_DeletedPages OR Title:OneNote_RecycleBin)",w='({searchterms}) (NOT ContentClass:ExternalLink AND NOT FileExtension:vtt AND NOT (Title:OneNote_DeletedPages OR Title:OneNote_RecycleBin) AND NOT SecondaryFileExtension:onetoc2 AND NOT (ContentClass:STS_List_544 OR ContentClass:STS_ListItem_544) AND NOT WebTemplate:SPSPERS AND NOT (ContentClass:STS_Site AND SiteTemplateId:21) AND NOT (ContentClass:STS_Site AND SiteTemplateId:22) AND NOT (ContentClass:STS_List_DocumentLibrary AND SiteTemplateId:21) AND NOT (ContentClass:STS_List_DocumentLibrary AND Author:"system account"))',b=" AND (SPTranslationLanguage:{0} OR (NOT SPTranslatedLanguages:{0} AND NOT SPIsTranslation:true))"})(i=t.Substrate||(t.Substrate={}))})(t=n.Service||(n.Service={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(n){var t;(function(n){function t(n){return{AsyncEntityResolutionTokens:[n||""]}}n.buildSubstrateResolveEntitiesAsyncRequest=t})(t=n.Substrate||(n.Substrate={}))})(t=n.Service||(n.Service={}))}(BingAtWork||(BingAtWork={}));new BingAtWork.BundleReady("OnScriptLoad:BingAtWork:BfbMidgardAsyncBundle")